<application>
  <component name="VimSettings">
    <state version="4" enabled="true" />
    <globalmarks />
    <filemarks>
      <file name="$APPLICATION_CONFIG_DIR$/scratches/rest-api.http" timestamp="1535636945588">
        <mark key="[" line="3" column="0" />
        <mark key="]" line="3" column="0" />
        <mark key="." line="3" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/black/abierto/bomba-cubierta.html.twig" timestamp="1542646328223">
        <mark key="[" line="0" column="0" />
        <mark key="]" line="0" column="0" />
        <mark key="." line="0" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/pcc.Browser.js" timestamp="1542638079735">
        <mark key="'" line="143" column="18" />
        <mark key="[" line="163" column="30" />
        <mark key="]" line="159" column="0" />
        <mark key="." line="159" column="0" />
        <mark key="^" line="160" column="28" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/article/detail/datasheet/article-buy-buttons.html.twig" timestamp="1535712114008">
        <mark key="[" line="23" column="0" />
        <mark key="]" line="23" column="0" />
        <mark key="." line="23" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/Cms/CmsCategoriesController.php" timestamp="1536587388428">
        <mark key="[" line="34" column="31" />
        <mark key="]" line="34" column="35" />
        <mark key="." line="34" column="35" />
        <mark key="^" line="34" column="35" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/DFPS_SCRIPTS_18.html.twig" timestamp="1542116445335" />
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/preblack/bomba-cubierta.html.twig" timestamp="1542645087820">
        <mark key="[" line="0" column="0" />
        <mark key="]" line="0" column="0" />
        <mark key="." line="0" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/web/app_dev.php" timestamp="1542039473525">
        <mark key="[" line="26" column="39" />
        <mark key="]" line="4" column="35" />
        <mark key="." line="4" column="35" />
        <mark key="^" line="4" column="35" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/preblack/pre-black.html.twig" timestamp="1542637313987">
        <mark key="[" line="51" column="18" />
        <mark key="]" line="52" column="10" />
        <mark key="^" line="52" column="10" />
        <mark key="." line="52" column="10" />
      </file>
      <file name="/Dummy.txt" timestamp="1542643932755">
        <mark key="[" line="0" column="0" />
        <mark key="]" line="0" column="8" />
        <mark key="." line="0" column="8" />
      </file>
      <file name="$USER_HOME$/src/pccfront/app/config/parameters.yml" timestamp="1542115909557">
        <mark key="[" line="42" column="25" />
        <mark key="]" line="42" column="23" />
        <mark key="." line="42" column="23" />
        <mark key="^" line="51" column="31" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/promotions/black-friday-18/index.js" timestamp="1542647006340">
        <mark key="[" line="158" column="0" />
        <mark key="]" line="158" column="0" />
        <mark key="." line="158" column="0" />
        <mark key="^" line="157" column="87" />
      </file>
      <file name="$USER_HOME$/src/pccfront/bin/gjslint/gjslint.conf" timestamp="1535635384252">
        <mark key="[" line="0" column="0" />
        <mark key="]" line="0" column="0" />
        <mark key="." line="0" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/banner.html.twig" timestamp="1542115188544">
        <mark key="." line="25" column="5" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/black/abierto/index.html.twig" timestamp="1542646830320">
        <mark key="[" line="22" column="0" />
        <mark key="]" line="22" column="0" />
        <mark key="." line="22" column="0" />
        <mark key="^" line="6" column="17" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/StargateController.php" timestamp="1536584755208">
        <mark key="[" line="70" column="0" />
        <mark key="]" line="70" column="0" />
        <mark key="." line="70" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/Shopping/Order/order-detail.html.twig" timestamp="1542645168170">
        <mark key="[" line="146" column="0" />
        <mark key="]" line="146" column="71" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/black/black.html.twig" timestamp="1542651299309">
        <mark key="[" line="39" column="53" />
        <mark key="]" line="40" column="0" />
        <mark key="^" line="39" column="0" />
        <mark key="." line="40" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/Statics/BlackFriday2018/BlackFriday2018Controller.php" timestamp="1542639209443">
        <mark key="[" line="4" column="0" />
        <mark key="]" line="4" column="0" />
        <mark key="." line="4" column="0" />
        <mark key="^" line="175" column="48" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/preblack/carousel.html.twig" timestamp="1542639879823">
        <mark key="[" line="4" column="46" />
        <mark key="]" line="4" column="50" />
        <mark key="." line="4" column="50" />
        <mark key="^" line="4" column="50" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/statics/landing/black-friday-2018/black/abierto/carousel.html.twig" timestamp="1542643930276">
        <mark key="[" line="18" column="0" />
        <mark key="]" line="18" column="0" />
        <mark key="." line="18" column="0" />
        <mark key="^" line="18" column="37" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/Cms/Categories/pcc.Cms.Categories.js" timestamp="1536746563978">
        <mark key="[" line="104" column="0" />
        <mark key="]" line="104" column="0" />
        <mark key="." line="104" column="0" />
        <mark key="^" line="104" column="40" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/googleTagManager/DFP.html.twig" timestamp="1543217562116">
        <mark key="[" line="0" column="0" />
        <mark key="]" line="0" column="0" />
        <mark key="." line="0" column="0" />
      </file>
      <file name="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/js/common/pcc-fdfba27ae1.Browser.js" timestamp="1542696396132">
        <mark key="[" line="54" column="0" />
        <mark key="]" line="54" column="0" />
        <mark key="." line="54" column="0" />
      </file>
    </filemarks>
    <jumps>
      <jump line="28" column="0" filename="$USER_HOME$/IdeaProjects/pruebecilla/src/zapalevi/view/miView.java" />
      <jump line="23" column="30" filename="$USER_HOME$/IdeaProjects/pruebecilla/src/zapalevi/event/pinchaPulsado.java" />
      <jump line="96" column="0" filename="$USER_HOME$/IdeaProjects/pruebecilla/src/zapalevi/event/pinchaPulsado.java" />
      <jump line="121" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="309" column="8" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="88" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="108" column="8" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="109" column="21" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="110" column="19" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="112" column="57" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="116" column="32" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="268" column="12" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/ArticlesController.php" />
      <jump line="247" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/pcc.core.js" />
      <jump line="111" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/article/detail/datasheet/article-buy-buttons-drop-ship.html.twig" />
      <jump line="9" column="8" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/article/detail/article-detail-drop-shipping.html.twig" />
      <jump line="40" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/article/detail/article-detail-drop-shipping.html.twig" />
      <jump line="15" column="35" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/gaApi/gaApi.js" />
      <jump line="438" column="26" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="423" column="11" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="281" column="5" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="424" column="4" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="426" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="21" column="3" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="83" column="7" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="39" column="15" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="135" column="25" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="539" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserController.php" />
      <jump line="350" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserController.php" />
      <jump line="281" column="12" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserPanelController.php" />
      <jump line="50" column="53" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserPanelController.php" />
      <jump line="292" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserPanelController.php" />
      <jump line="1116" column="44" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserPanelController.php" />
      <jump line="216" column="0" filename="$USER_HOME$/src/pccfront/.eslintrc.js" />
      <jump line="170" column="13" filename="$USER_HOME$/src/pccfront/.eslintrc.json" />
      <jump line="190" column="12" filename="$USER_HOME$/src/pccfront/.eslintrc.json" />
      <jump line="28" column="8" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/article/detail/article_detail.js" />
      <jump line="166" column="13" filename="$USER_HOME$/src/pccfront/.eslintrc.json" />
      <jump line="0" column="0" filename="$USER_HOME$/src/pccfront/.eslintrc.json" />
      <jump line="258" column="0" filename="$USER_HOME$/src/pccfront/.eslintrc.json" />
      <jump line="243" column="33" filename="$USER_HOME$/src/pccfront/.eslintrc.json" />
      <jump line="1508" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/article/detail/article_detail.js" />
      <jump line="102" column="0" filename="$USER_HOME$/src/frontst/src/App.js" />
      <jump line="327" column="0" filename="$USER_HOME$/src/frontst/node_modules/react/cjs/react.development.js" />
      <jump line="19" column="51" filename="$USER_HOME$/src/frontst/src/paramita.svg" />
      <jump line="0" column="0" filename="$USER_HOME$/src/frontst/src/paramita.svg" />
      <jump line="2249" column="0" filename="$USER_HOME$/src/frontst/src/paramita.svg" />
      <jump line="22" column="0" filename="$USER_HOME$/src/frontst/src/App.js" />
      <jump line="565" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/article/detail/article_detail.js" />
      <jump line="29" column="65" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/base/pcc.Component.js" />
      <jump line="38" column="8" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/base/pcc.Component.js" />
      <jump line="790" column="35" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Shopping/Cart/CartArticle.php" />
      <jump line="55" column="23" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Shopping/Cart/CartArticle.php" />
      <jump line="0" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Shopping/Cart/CartArticle.php" />
      <jump line="793" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Shopping/Cart/CartArticle.php" />
      <jump line="751" column="36" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/Article/SuperFamiliesArticlesController.php" />
      <jump line="2468" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/Article/SuperFamiliesArticlesController.php" />
      <jump line="505" column="6" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Article/ArticleDetail.php" />
      <jump line="139" column="38" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Article/ArticleDetail.php" />
      <jump line="57" column="4" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Article/Detail/SuperFamily/SuperFamily.php" />
      <jump line="0" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Mappings/Article/ArticleDetail.php" />
      <jump line="518" column="4" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="587" column="3" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="528" column="9" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="112" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="16" column="4" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="652" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="522" column="4" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="523" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="525" column="3" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="411" column="38" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="76" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/base/footjs.html.twig" />
      <jump line="23" column="4" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/test/gaApi/gaApi.node.test.js" />
      <jump line="13" column="4" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/test/gaApi/gaApi.node.test.js" />
      <jump line="633" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/test/gaApi/gaApi.node.test.js" />
      <jump line="352" column="8" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/gaApi/gaApi.js" />
      <jump line="374" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/gaApi/gaApi.js" />
      <jump line="0" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/gaApi/gaApi.js" />
      <jump line="376" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/gaApi/gaApi.js" />
      <jump line="0" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/Cart/CartController.php" />
      <jump line="68" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/base/pcc.Component.js" />
      <jump line="16" column="66" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/base/pcc.Component.spec.js" />
      <jump line="43" column="11" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/base/pcc.Component.spec.js" />
      <jump line="72" column="36" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/StargateController.php" />
      <jump line="61" column="26" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/tokywoky.js" />
      <jump line="1549" column="20" filename="$USER_HOME$/src/pccfront/web/bundles/pccweb/raw/js/article/detail/article_detail.js" />
      <jump line="815" column="33" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserController.php" />
      <jump line="16070" column="0" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserController.php" />
      <jump line="15570" column="99" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserController.php" />
      <jump line="837" column="69" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserController.php" />
      <jump line="33" column="15" filename="$USER_HOME$/Downloads/PostalCodeSpain_List_2004october.txt" />
      <jump line="0" column="0" filename="$USER_HOME$/Downloads/PostalCodeSpain_List_2004october.txt" />
      <jump line="57133" column="0" filename="$USER_HOME$/Downloads/PostalCodeSpain_List_2004october.txt" />
      <jump line="56906" column="21" filename="$USER_HOME$/Downloads/PostalCodeSpain_List_2004october.txt" />
      <jump line="864" column="31" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Controller/UserController.php" />
      <jump line="436" column="70" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/views/user/panel/orders/modals/return-modal.html.twig" />
      <jump line="37" column="41" filename="$USER_HOME$/src/pccfront/composer.json" />
      <jump line="142" column="18" filename="$USER_HOME$/src/pccfront/src/Pcc/Bundle/WebBundle/Resources/public/raw/js/common/pcc.Browser.js" />
    </jumps>
    <registers>
      <register name="&quot;" type="2">
        <text encoding="base64">Cg==</text>
      </register>
      <register name="-" type="4">
        <text encoding="base64">IA==</text>
      </register>
      <register name="/" type="4">
        <text>lexi</text>
      </register>
      <register name="0" type="2">
        <text encoding="base64">ICAgIHsjPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL093bENhcm91c2VsMi8yLjMuNC9vd2wuY2Fyb3VzZWwubWluLmpzIj48L3NjcmlwdD4jfQo=</text>
      </register>
      <register name="1" type="2">
        <text encoding="base64">Cg==</text>
      </register>
      <register name="2" type="4">
        <text encoding="base64">ICAgIDxzY3JpcHQ+CiAgICAgICAgLyoqCiAgICAgICAgICogT3dsIENhcm91c2VsIHYyLjMuNAogICAgICAgICAqIENvcHlyaWdodCAyMDEzLTIwMTggRGF2aWQgRGV1dHNjaAogICAgICAgICAqIExpY2Vuc2VkIHVuZGVyOiBTRUUgTElDRU5TRSBJTiBodHRwczovL2dpdGh1Yi5jb20vT3dsQ2Fyb3VzZWwyL093bENhcm91c2VsMi9ibG9iL21hc3Rlci9MSUNFTlNFCiAgICAgICAgICovCiAgICAgICAgIWZ1bmN0aW9uKGEsIGIsIGMsIGQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gZShiLCBjKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBhLmV4dGVuZCh7fSwgZS5EZWZhdWx0cywgYyksCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZWxlbWVudCA9IGEoYiksCiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMgPSB7fSwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbHVnaW5zID0ge30sCiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VwcmVzcyA9IHt9LAogICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnQgPSBudWxsLAogICAgICAgICAgICAgICAgICAgIHRoaXMuX3NwZWVkID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb29yZGluYXRlcyA9IFtdLAogICAgICAgICAgICAgICAgICAgIHRoaXMuX2JyZWFrcG9pbnQgPSBudWxsLAogICAgICAgICAgICAgICAgICAgIHRoaXMuX3dpZHRoID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9pdGVtcyA9IFtdLAogICAgICAgICAgICAgICAgICAgIHRoaXMuX2Nsb25lcyA9IFtdLAogICAgICAgICAgICAgICAgICAgIHRoaXMuX21lcmdlcnMgPSBbXSwKICAgICAgICAgICAgICAgICAgICB0aGlzLl93aWR0aHMgPSBbXSwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnZhbGlkYXRlZCA9IHt9LAogICAgICAgICAgICAgICAgICAgIHRoaXMuX3BpcGUgPSBbXSwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9kcmFnID0gewogICAgICAgICAgICAgICAgICAgICAgICB0aW1lOiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50ZXI6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0YWdlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBudWxsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZXMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICB0YWdzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsaXppbmc6IFsiYnVzeSJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW5nOiBbImJ1c3kiXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyYWdnaW5nOiBbImludGVyYWN0aW5nIl0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYS5lYWNoKFsib25SZXNpemUiLCAib25UaHJvdHRsZWRSZXNpemUiXSwgYS5wcm94eShmdW5jdGlvbihiLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXJzW2NdID0gYS5wcm94eSh0aGlzW2NdLCB0aGlzKQogICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKSwKICAgICAgICAgICAgICAgICAgICBhLmVhY2goZS5QbHVnaW5zLCBhLnByb3h5KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGx1Z2luc1thLmNoYXJBdCgwKS50b0xvd2VyQ2FzZSgpICsgYS5zbGljZSgxKV0gPSBuZXcgYih0aGlzKQogICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKSwKICAgICAgICAgICAgICAgICAgICBhLmVhY2goZS5Xb3JrZXJzLCBhLnByb3h5KGZ1bmN0aW9uKGIsIGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGlwZS5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcjogYy5maWx0ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydW46IGEucHJveHkoYy5ydW4sIHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpLAogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dXAoKSwKICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxpemUoKQogICAgICAgICAgICB9CiAgICAgICAgICAgIGUuRGVmYXVsdHMgPSB7CiAgICAgICAgICAgICAgICBpdGVtczogMywKICAgICAgICAgICAgICAgIGxvb3A6ICExLAogICAgICAgICAgICAgICAgY2VudGVyOiAhMSwKICAgICAgICAgICAgICAgIHJld2luZDogITEsCiAgICAgICAgICAgICAgICBjaGVja1Zpc2liaWxpdHk6ICEwLAogICAgICAgICAgICAgICAgbW91c2VEcmFnOiAhMCwKICAgICAgICAgICAgICAgIHRvdWNoRHJhZzogITAsCiAgICAgICAgICAgICAgICBwdWxsRHJhZzogITAsCiAgICAgICAgICAgICAgICBmcmVlRHJhZzogITEsCiAgICAgICAgICAgICAgICBtYXJnaW46IDAsCiAgICAgICAgICAgICAgICBzdGFnZVBhZGRpbmc6IDAsCiAgICAgICAgICAgICAgICBtZXJnZTogITEsCiAgICAgICAgICAgICAgICBtZXJnZUZpdDogITAsCiAgICAgICAgICAgICAgICBhdXRvV2lkdGg6ICExLAogICAgICAgICAgICAgICAgc3RhcnRQb3NpdGlvbjogMCwKICAgICAgICAgICAgICAgIHJ0bDogITEsCiAgICAgICAgICAgICAgICBzbWFydFNwZWVkOiAyNTAsCiAgICAgICAgICAgICAgICBmbHVpZFNwZWVkOiAhMSwKICAgICAgICAgICAgICAgIGRyYWdFbmRTcGVlZDogITEsCiAgICAgICAgICAgICAgICByZXNwb25zaXZlOiB7fSwKICAgICAgICAgICAgICAgIHJlc3BvbnNpdmVSZWZyZXNoUmF0ZTogMjAwLAogICAgICAgICAgICAgICAgcmVzcG9uc2l2ZUJhc2VFbGVtZW50OiBiLAogICAgICAgICAgICAgICAgZmFsbGJhY2tFYXNpbmc6ICJzd2luZyIsCiAgICAgICAgICAgICAgICBzbGlkZVRyYW5zaXRpb246ICIiLAogICAgICAgICAgICAgICAgaW5mbzogITEsCiAgICAgICAgICAgICAgICBuZXN0ZWRJdGVtU2VsZWN0b3I6ICExLAogICAgICAgICAgICAgICAgaXRlbUVsZW1lbnQ6ICJkaXYiLAogICAgICAgICAgICAgICAgc3RhZ2VFbGVtZW50OiAiZGl2IiwKICAgICAgICAgICAgICAgIHJlZnJlc2hDbGFzczogIm93bC1yZWZyZXNoIiwKICAgICAgICAgICAgICAgIGxvYWRlZENsYXNzOiAib3dsLWxvYWRlZCIsCiAgICAgICAgICAgICAgICBsb2FkaW5nQ2xhc3M6ICJvd2wtbG9hZGluZyIsCiAgICAgICAgICAgICAgICBydGxDbGFzczogIm93bC1ydGwiLAogICAgICAgICAgICAgICAgcmVzcG9uc2l2ZUNsYXNzOiAib3dsLXJlc3BvbnNpdmUiLAogICAgICAgICAgICAgICAgZHJhZ0NsYXNzOiAib3dsLWRyYWciLAogICAgICAgICAgICAgICAgaXRlbUNsYXNzOiAib3dsLWl0ZW0iLAogICAgICAgICAgICAgICAgc3RhZ2VDbGFzczogIm93bC1zdGFnZSIsCiAgICAgICAgICAgICAgICBzdGFnZU91dGVyQ2xhc3M6ICJvd2wtc3RhZ2Utb3V0ZXIiLAogICAgICAgICAgICAgICAgZ3JhYkNsYXNzOiAib3dsLWdyYWIiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBlLldpZHRoID0gewogICAgICAgICAgICAgICAgICAgIERlZmF1bHQ6ICJkZWZhdWx0IiwKICAgICAgICAgICAgICAgICAgICBJbm5lcjogImlubmVyIiwKICAgICAgICAgICAgICAgICAgICBPdXRlcjogIm91dGVyIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGUuVHlwZSA9IHsKICAgICAgICAgICAgICAgICAgICBFdmVudDogImV2ZW50IiwKICAgICAgICAgICAgICAgICAgICBTdGF0ZTogInN0YXRlIgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGUuUGx1Z2lucyA9IHt9LAogICAgICAgICAgICAgICAgZS5Xb3JrZXJzID0gW3sKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsid2lkdGgiLCAic2V0dGluZ3MiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl93aWR0aCA9IHRoaXMuJGVsZW1lbnQud2lkdGgoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsid2lkdGgiLCAiaXRlbXMiLCAic2V0dGluZ3MiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYS5jdXJyZW50ID0gdGhpcy5faXRlbXMgJiYgdGhpcy5faXRlbXNbdGhpcy5yZWxhdGl2ZSh0aGlzLl9jdXJyZW50KV0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiBbIml0ZW1zIiwgInNldHRpbmdzIl0sCiAgICAgICAgICAgICAgICAgICAgcnVuOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RhZ2UuY2hpbGRyZW4oIi5jbG9uZWQiKS5yZW1vdmUoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsid2lkdGgiLCAiaXRlbXMiLCAic2V0dGluZ3MiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnNldHRpbmdzLm1hcmdpbiB8fCAiIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBjID0gIXRoaXMuc2V0dGluZ3MuYXV0b1dpZHRoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGQgPSB0aGlzLnNldHRpbmdzLnJ0bAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6ICJhdXRvIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtYXJnaW4tbGVmdCI6IGQgPyBiIDogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibWFyZ2luLXJpZ2h0IjogZCA/ICIiIDogYgogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAhYyAmJiB0aGlzLiRzdGFnZS5jaGlsZHJlbigpLmNzcyhlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuY3NzID0gZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsid2lkdGgiLCAiaXRlbXMiLCAic2V0dGluZ3MiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSAodGhpcy53aWR0aCgpIC8gdGhpcy5zZXR0aW5ncy5pdGVtcykudG9GaXhlZCgzKSAtIHRoaXMuc2V0dGluZ3MubWFyZ2luCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGMgPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGQgPSB0aGlzLl9pdGVtcy5sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZSA9ICF0aGlzLnNldHRpbmdzLmF1dG9XaWR0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBmID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYS5pdGVtcyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lcmdlOiAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBiCiAgICAgICAgICAgICAgICAgICAgICAgIH07IGQtLTsgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IHRoaXMuX21lcmdlcnNbZF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IHRoaXMuc2V0dGluZ3MubWVyZ2VGaXQgJiYgTWF0aC5taW4oYywgdGhpcy5zZXR0aW5ncy5pdGVtcykgfHwgYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLml0ZW1zLm1lcmdlID0gYyA+IDEgfHwgYS5pdGVtcy5tZXJnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmW2RdID0gZSA/IGIgKiBjIDogdGhpcy5faXRlbXNbZF0ud2lkdGgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2lkdGhzID0gZgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsiaXRlbXMiLCAic2V0dGluZ3MiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGMgPSB0aGlzLl9pdGVtcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBkID0gdGhpcy5zZXR0aW5ncwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gTWF0aC5tYXgoMiAqIGQuaXRlbXMsIDQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGYgPSAyICogTWF0aC5jZWlsKGMubGVuZ3RoIC8gMikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZyA9IGQubG9vcCAmJiBjLmxlbmd0aCA/IGQucmV3aW5kID8gZSA6IE1hdGgubWF4KGUsIGYpIDogMAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBoID0gIiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgaSA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGcgLz0gMjsgZyA+IDA7ICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCh0aGlzLm5vcm1hbGl6ZShiLmxlbmd0aCAvIDIsICEwKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaCArPSBjW2JbYi5sZW5ndGggLSAxXV1bMF0ub3V0ZXJIVE1MLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIucHVzaCh0aGlzLm5vcm1hbGl6ZShjLmxlbmd0aCAtIDEgLSAoYi5sZW5ndGggLSAxKSAvIDIsICEwKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGNbYltiLmxlbmd0aCAtIDFdXVswXS5vdXRlckhUTUwgKyBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgLT0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xvbmVzID0gYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEoaCkuYWRkQ2xhc3MoImNsb25lZCIpLmFwcGVuZFRvKHRoaXMuJHN0YWdlKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEoaSkuYWRkQ2xhc3MoImNsb25lZCIpLnByZXBlbmRUbyh0aGlzLiRzdGFnZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiBbIndpZHRoIiwgIml0ZW1zIiwgInNldHRpbmdzIl0sCiAgICAgICAgICAgICAgICAgICAgcnVuOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgYSA9IHRoaXMuc2V0dGluZ3MucnRsID8gMSA6IC0xLCBiID0gdGhpcy5fY2xvbmVzLmxlbmd0aCArIHRoaXMuX2l0ZW1zLmxlbmd0aCwgYyA9IC0xLCBkID0gMCwgZSA9IDAsIGYgPSBbXTsgKytjIDwgYjsgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGZbYyAtIDFdIHx8IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX3dpZHRoc1t0aGlzLnJlbGF0aXZlKGMpXSArIHRoaXMuc2V0dGluZ3MubWFyZ2luLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYucHVzaChkICsgZSAqIGEpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb29yZGluYXRlcyA9IGYKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiBbIndpZHRoIiwgIml0ZW1zIiwgInNldHRpbmdzIl0sCiAgICAgICAgICAgICAgICAgICAgcnVuOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLnNldHRpbmdzLnN0YWdlUGFkZGluZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBiID0gdGhpcy5fY29vcmRpbmF0ZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgYyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBNYXRoLmNlaWwoTWF0aC5hYnMoYltiLmxlbmd0aCAtIDFdKSkgKyAyICogYSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJwYWRkaW5nLWxlZnQiOiBhIHx8ICIiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInBhZGRpbmctcmlnaHQiOiBhIHx8ICIiCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0YWdlLmNzcyhjKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsid2lkdGgiLCAiaXRlbXMiLCAic2V0dGluZ3MiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLl9jb29yZGluYXRlcy5sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgYyA9ICF0aGlzLnNldHRpbmdzLmF1dG9XaWR0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBkID0gdGhpcy4kc3RhZ2UuY2hpbGRyZW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGMgJiYgYS5pdGVtcy5tZXJnZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBiLS07ICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmNzcy53aWR0aCA9IHRoaXMuX3dpZHRoc1t0aGlzLnJlbGF0aXZlKGIpXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5lcShiKS5jc3MoYS5jc3MpOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjICYmIChhLmNzcy53aWR0aCA9IGEuaXRlbXMud2lkdGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5jc3MoYS5jc3MpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsiaXRlbXMiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb29yZGluYXRlcy5sZW5ndGggPCAxICYmIHRoaXMuJHN0YWdlLnJlbW92ZUF0dHIoInN0eWxlIikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgZmlsdGVyOiBbIndpZHRoIiwgIml0ZW1zIiwgInNldHRpbmdzIl0sCiAgICAgICAgICAgICAgICAgICAgcnVuOiBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGEuY3VycmVudCA9IGEuY3VycmVudCA/IHRoaXMuJHN0YWdlLmNoaWxkcmVuKCkuaW5kZXgoYS5jdXJyZW50KSA6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmN1cnJlbnQgPSBNYXRoLm1heCh0aGlzLm1pbmltdW0oKSwgTWF0aC5taW4odGhpcy5tYXhpbXVtKCksIGEuY3VycmVudCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldChhLmN1cnJlbnQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgIGZpbHRlcjogWyJwb3NpdGlvbiJdLAogICAgICAgICAgICAgICAgICAgIHJ1bjogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSh0aGlzLmNvb3JkaW5hdGVzKHRoaXMuX2N1cnJlbnQpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6IFsid2lkdGgiLCAicG9zaXRpb24iLCAiaXRlbXMiLCAic2V0dGluZ3MiXSwKICAgICAgICAgICAgICAgICAgICBydW46IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSwgYiwgYywgZCwgZSA9IHRoaXMuc2V0dGluZ3MucnRsID8gMSA6IC0xLCBmID0gMiAqIHRoaXMuc2V0dGluZ3Muc3RhZ2VQYWRkaW5nLCBnID0gdGhpcy5jb29yZGluYXRlcyh0aGlzLmN1cnJlbnQoKSkgKyBmLCBoID0gZyArIHRoaXMud2lkdGgoKSAqIGUsIGkgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHRoaXMuX2Nvb3JkaW5hdGVzLmxlbmd0aDsgYyA8IGQ7IGMrKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSB0aGlzLl9jb29yZGluYXRlc1tjIC0gMV0gfHwgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gTWF0aC5hYnModGhpcy5fY29vcmRpbmF0ZXNbY10pICsgZiAqIGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodGhpcy5vcChhLCAiPD0iLCBnKSAmJiB0aGlzLm9wKGEsICI+IiwgaCkgfHwgdGhpcy5vcChiLCAiPCIsIGcpICYmIHRoaXMub3AoYiwgIj4iLCBoKSkgJiYgaS5wdXNoKGMpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZS5jaGlsZHJlbigiLmFjdGl2ZSIpLnJlbW92ZUNsYXNzKCJhY3RpdmUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0YWdlLmNoaWxkcmVuKCI6ZXEoIiArIGkuam9pbigiKSwgOmVxKCIpICsgIikiKS5hZGRDbGFzcygiYWN0aXZlIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZS5jaGlsZHJlbigiLmNlbnRlciIpLnJlbW92ZUNsYXNzKCJjZW50ZXIiKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5jZW50ZXIgJiYgdGhpcy4kc3RhZ2UuY2hpbGRyZW4oKS5lcSh0aGlzLmN1cnJlbnQoKSkuYWRkQ2xhc3MoImNlbnRlciIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5pbml0aWFsaXplU3RhZ2UgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZSA9IHRoaXMuJGVsZW1lbnQuZmluZCgiLiIgKyB0aGlzLnNldHRpbmdzLnN0YWdlQ2xhc3MpLAogICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0YWdlLmxlbmd0aCB8fCAodGhpcy4kZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RhZ2UgPSBhKCI8IiArIHRoaXMuc2V0dGluZ3Muc3RhZ2VFbGVtZW50ICsgIj4iLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogdGhpcy5zZXR0aW5ncy5zdGFnZUNsYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLndyYXAoYSgiPGRpdi8+IiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6IHRoaXMuc2V0dGluZ3Muc3RhZ2VPdXRlckNsYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZWxlbWVudC5hcHBlbmQodGhpcy4kc3RhZ2UucGFyZW50KCkpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuaW5pdGlhbGl6ZUl0ZW1zID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLiRlbGVtZW50LmZpbmQoIi5vd2wtaXRlbSIpOwogICAgICAgICAgICAgICAgICAgIGlmIChiLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2l0ZW1zID0gYi5nZXQoKS5tYXAoZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEoYikKICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZXJnZXJzID0gdGhpcy5faXRlbXMubWFwKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgdGhpcy5yZWZyZXNoKCk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXBsYWNlKHRoaXMuJGVsZW1lbnQuY2hpbGRyZW4oKS5ub3QodGhpcy4kc3RhZ2UucGFyZW50KCkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Zpc2libGUoKSA/IHRoaXMucmVmcmVzaCgpIDogdGhpcy5pbnZhbGlkYXRlKCJ3aWR0aCIpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50LnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5sb2FkaW5nQ2xhc3MpLmFkZENsYXNzKHRoaXMub3B0aW9ucy5sb2FkZWRDbGFzcykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5lbnRlcigiaW5pdGlhbGl6aW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigiaW5pdGlhbGl6ZSIpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50LnRvZ2dsZUNsYXNzKHRoaXMuc2V0dGluZ3MucnRsQ2xhc3MsIHRoaXMuc2V0dGluZ3MucnRsKSwKICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmF1dG9XaWR0aCAmJiAhdGhpcy5pcygicHJlLWxvYWRpbmciKSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSwgYiwgYzsKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IHRoaXMuJGVsZW1lbnQuZmluZCgiaW1nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gdGhpcy5zZXR0aW5ncy5uZXN0ZWRJdGVtU2VsZWN0b3IgPyAiLiIgKyB0aGlzLnNldHRpbmdzLm5lc3RlZEl0ZW1TZWxlY3RvciA6IGQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy4kZWxlbWVudC5jaGlsZHJlbihiKS53aWR0aCgpLAogICAgICAgICAgICAgICAgICAgICAgICBhLmxlbmd0aCAmJiBjIDw9IDAgJiYgdGhpcy5wcmVsb2FkQXV0b1dpZHRoSW1hZ2VzKGEpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZVN0YWdlKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZUl0ZW1zKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudEhhbmRsZXJzKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGVhdmUoImluaXRpYWxpemluZyIpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoImluaXRpYWxpemVkIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmlzVmlzaWJsZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAhdGhpcy5zZXR0aW5ncy5jaGVja1Zpc2liaWxpdHkgfHwgdGhpcy4kZWxlbWVudC5pcygiOnZpc2libGUiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuc2V0dXAgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMudmlld3BvcnQoKQogICAgICAgICAgICAgICAgICAgICAgICAsIGMgPSB0aGlzLm9wdGlvbnMucmVzcG9uc2l2ZQogICAgICAgICAgICAgICAgICAgICAgICAsIGQgPSAtMQogICAgICAgICAgICAgICAgICAgICAgICAsIGUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIGMgPyAoYS5lYWNoKGMsIGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYSA8PSBiICYmIGEgPiBkICYmIChkID0gTnVtYmVyKGEpKQogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICBlID0gYS5leHRlbmQoe30sIHRoaXMub3B0aW9ucywgY1tkXSksCiAgICAgICAgICAgICAgICAgICAgImZ1bmN0aW9uIiA9PSB0eXBlb2YgZS5zdGFnZVBhZGRpbmcgJiYgKGUuc3RhZ2VQYWRkaW5nID0gZS5zdGFnZVBhZGRpbmcoKSksCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBlLnJlc3BvbnNpdmUsCiAgICAgICAgICAgICAgICAgICAgZS5yZXNwb25zaXZlQ2xhc3MgJiYgdGhpcy4kZWxlbWVudC5hdHRyKCJjbGFzcyIsIHRoaXMuJGVsZW1lbnQuYXR0cigiY2xhc3MiKS5yZXBsYWNlKG5ldyBSZWdFeHAoIigiICsgdGhpcy5vcHRpb25zLnJlc3BvbnNpdmVDbGFzcyArICItKVxcUytcXHMiLCJnIiksICIkMSIgKyBkKSkpIDogZSA9IGEuZXh0ZW5kKHt9LCB0aGlzLm9wdGlvbnMpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoImNoYW5nZSIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogInNldHRpbmdzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYnJlYWtwb2ludCA9IGQsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MgPSBlLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRhdGUoInNldHRpbmdzIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigiY2hhbmdlZCIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogInNldHRpbmdzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5zZXR0aW5ncwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUub3B0aW9uc0xvZ2ljID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5hdXRvV2lkdGggJiYgKHRoaXMuc2V0dGluZ3Muc3RhZ2VQYWRkaW5nID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubWVyZ2UgPSAhMSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnByZXBhcmUgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnRyaWdnZXIoInByZXBhcmUiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGIKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYy5kYXRhIHx8IChjLmRhdGEgPSBhKCI8IiArIHRoaXMuc2V0dGluZ3MuaXRlbUVsZW1lbnQgKyAiLz4iKS5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuaXRlbUNsYXNzKS5hcHBlbmQoYikpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoInByZXBhcmVkIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogYy5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICBjLmRhdGEKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGIgPSAwLCBjID0gdGhpcy5fcGlwZS5sZW5ndGgsIGQgPSBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNbYV0KICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLl9pbnZhbGlkYXRlZCksIGUgPSB7fTsgYiA8IGM7ICkKICAgICAgICAgICAgICAgICAgICAgICAgKHRoaXMuX2ludmFsaWRhdGVkLmFsbCB8fCBhLmdyZXAodGhpcy5fcGlwZVtiXS5maWx0ZXIsIGQpLmxlbmd0aCA+IDApICYmIHRoaXMuX3BpcGVbYl0ucnVuKGUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYisrOwogICAgICAgICAgICAgICAgICAgIHRoaXMuX2ludmFsaWRhdGVkID0ge30sCiAgICAgICAgICAgICAgICAgICAgIXRoaXMuaXMoInZhbGlkIikgJiYgdGhpcy5lbnRlcigidmFsaWQiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUud2lkdGggPSBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChhID0gYSB8fCBlLldpZHRoLkRlZmF1bHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBlLldpZHRoLklubmVyOgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIGUuV2lkdGguT3V0ZXI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd2lkdGggLSAyICogdGhpcy5zZXR0aW5ncy5zdGFnZVBhZGRpbmcgKyB0aGlzLnNldHRpbmdzLm1hcmdpbgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnJlZnJlc2ggPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmVudGVyKCJyZWZyZXNoaW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigicmVmcmVzaCIpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHVwKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uc0xvZ2ljKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3ModGhpcy5vcHRpb25zLnJlZnJlc2hDbGFzcyksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLnJlZnJlc2hDbGFzcyksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGVhdmUoInJlZnJlc2hpbmciKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCJyZWZyZXNoZWQiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUub25UaHJvdHRsZWRSZXNpemUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBiLmNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZVRpbWVyKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNpemVUaW1lciA9IGIuc2V0VGltZW91dCh0aGlzLl9oYW5kbGVycy5vblJlc2l6ZSwgdGhpcy5zZXR0aW5ncy5yZXNwb25zaXZlUmVmcmVzaFJhdGUpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5vblJlc2l6ZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXRoaXMuX2l0ZW1zLmxlbmd0aCAmJiAodGhpcy5fd2lkdGggIT09IHRoaXMuJGVsZW1lbnQud2lkdGgoKSAmJiAoISF0aGlzLmlzVmlzaWJsZSgpICYmICh0aGlzLmVudGVyKCJyZXNpemluZyIpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoInJlc2l6ZSIpLmlzRGVmYXVsdFByZXZlbnRlZCgpID8gKHRoaXMubGVhdmUoInJlc2l6aW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAhMSkgOiAodGhpcy5pbnZhbGlkYXRlKCJ3aWR0aCIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxlYXZlKCJyZXNpemluZyIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCB0aGlzLnRyaWdnZXIoInJlc2l6ZWQiKSkpKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnJlZ2lzdGVyRXZlbnRIYW5kbGVycyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGEuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoaXMuJHN0YWdlLm9uKGEuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCArICIub3dsLmNvcmUiLCBhLnByb3h5KHRoaXMub25UcmFuc2l0aW9uRW5kLCB0aGlzKSksCiAgICAgICAgICAgICAgICAgICAgITEgIT09IHRoaXMuc2V0dGluZ3MucmVzcG9uc2l2ZSAmJiB0aGlzLm9uKGIsICJyZXNpemUiLCB0aGlzLl9oYW5kbGVycy5vblRocm90dGxlZFJlc2l6ZSksCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5tb3VzZURyYWcgJiYgKHRoaXMuJGVsZW1lbnQuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmRyYWdDbGFzcyksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0YWdlLm9uKCJtb3VzZWRvd24ub3dsLmNvcmUiLCBhLnByb3h5KHRoaXMub25EcmFnU3RhcnQsIHRoaXMpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RhZ2Uub24oImRyYWdzdGFydC5vd2wuY29yZSBzZWxlY3RzdGFydC5vd2wuY29yZSIsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSwKICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnRvdWNoRHJhZyAmJiAodGhpcy4kc3RhZ2Uub24oInRvdWNoc3RhcnQub3dsLmNvcmUiLCBhLnByb3h5KHRoaXMub25EcmFnU3RhcnQsIHRoaXMpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RhZ2Uub24oInRvdWNoY2FuY2VsLm93bC5jb3JlIiwgYS5wcm94eSh0aGlzLm9uRHJhZ0VuZCwgdGhpcykpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUub25EcmFnU3RhcnQgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBudWxsOwogICAgICAgICAgICAgICAgICAgIDMgIT09IGIud2hpY2ggJiYgKGEuc3VwcG9ydC50cmFuc2Zvcm0gPyAoZCA9IHRoaXMuJHN0YWdlLmNzcygidHJhbnNmb3JtIikucmVwbGFjZSgvLipcKHxcKXwgL2csICIiKS5zcGxpdCgiLCIpLAogICAgICAgICAgICAgICAgICAgICAgICBkID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogZFsxNiA9PT0gZC5sZW5ndGggPyAxMiA6IDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgeTogZFsxNiA9PT0gZC5sZW5ndGggPyAxMyA6IDVdCiAgICAgICAgICAgICAgICAgICAgICAgIH0pIDogKGQgPSB0aGlzLiRzdGFnZS5wb3NpdGlvbigpLAogICAgICAgICAgICAgICAgICAgICAgICBkID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgeDogdGhpcy5zZXR0aW5ncy5ydGwgPyBkLmxlZnQgKyB0aGlzLiRzdGFnZS53aWR0aCgpIC0gdGhpcy53aWR0aCgpICsgdGhpcy5zZXR0aW5ncy5tYXJnaW4gOiBkLmxlZnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5OiBkLnRvcAogICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICB0aGlzLmlzKCJhbmltYXRpbmciKSAmJiAoYS5zdXBwb3J0LnRyYW5zZm9ybSA/IHRoaXMuYW5pbWF0ZShkLngpIDogdGhpcy4kc3RhZ2Uuc3RvcCgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRhdGUoInBvc2l0aW9uIikpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50LnRvZ2dsZUNsYXNzKHRoaXMub3B0aW9ucy5ncmFiQ2xhc3MsICJtb3VzZWRvd24iID09PSBiLnR5cGUpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwZWVkKDApLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kcmFnLnRpbWUgPSAobmV3IERhdGUpLmdldFRpbWUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZHJhZy50YXJnZXQgPSBhKGIudGFyZ2V0KSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZHJhZy5zdGFnZS5zdGFydCA9IGQsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2RyYWcuc3RhZ2UuY3VycmVudCA9IGQsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2RyYWcucG9pbnRlciA9IHRoaXMucG9pbnRlcihiKSwKICAgICAgICAgICAgICAgICAgICAgICAgYShjKS5vbigibW91c2V1cC5vd2wuY29yZSB0b3VjaGVuZC5vd2wuY29yZSIsIGEucHJveHkodGhpcy5vbkRyYWdFbmQsIHRoaXMpKSwKICAgICAgICAgICAgICAgICAgICAgICAgYShjKS5vbmUoIm1vdXNlbW92ZS5vd2wuY29yZSB0b3VjaG1vdmUub3dsLmNvcmUiLCBhLnByb3h5KGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5kaWZmZXJlbmNlKHRoaXMuX2RyYWcucG9pbnRlciwgdGhpcy5wb2ludGVyKGIpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEoYykub24oIm1vdXNlbW92ZS5vd2wuY29yZSB0b3VjaG1vdmUub3dsLmNvcmUiLCBhLnByb3h5KHRoaXMub25EcmFnTW92ZSwgdGhpcykpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZC54KSA8IE1hdGguYWJzKGQueSkgJiYgdGhpcy5pcygidmFsaWQiKSB8fCAoYi5wcmV2ZW50RGVmYXVsdCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW50ZXIoImRyYWdnaW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCJkcmFnIikpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLm9uRHJhZ01vdmUgPSBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICwgYyA9IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgLCBkID0gbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAsIGUgPSB0aGlzLmRpZmZlcmVuY2UodGhpcy5fZHJhZy5wb2ludGVyLCB0aGlzLnBvaW50ZXIoYSkpCiAgICAgICAgICAgICAgICAgICAgICAgICwgZiA9IHRoaXMuZGlmZmVyZW5jZSh0aGlzLl9kcmFnLnN0YWdlLnN0YXJ0LCBlKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmlzKCJkcmFnZ2luZyIpICYmIChhLnByZXZlbnREZWZhdWx0KCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubG9vcCA/IChiID0gdGhpcy5jb29yZGluYXRlcyh0aGlzLm1pbmltdW0oKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy5jb29yZGluYXRlcyh0aGlzLm1heGltdW0oKSArIDEpIC0gYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYueCA9ICgoZi54IC0gYikgJSBjICsgYykgJSBjICsgYikgOiAoYiA9IHRoaXMuc2V0dGluZ3MucnRsID8gdGhpcy5jb29yZGluYXRlcyh0aGlzLm1heGltdW0oKSkgOiB0aGlzLmNvb3JkaW5hdGVzKHRoaXMubWluaW11bSgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLnNldHRpbmdzLnJ0bCA/IHRoaXMuY29vcmRpbmF0ZXModGhpcy5taW5pbXVtKCkpIDogdGhpcy5jb29yZGluYXRlcyh0aGlzLm1heGltdW0oKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gdGhpcy5zZXR0aW5ncy5wdWxsRHJhZyA/IC0xICogZS54IC8gNSA6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLnggPSBNYXRoLm1heChNYXRoLm1pbihmLngsIGIgKyBkKSwgYyArIGQpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZHJhZy5zdGFnZS5jdXJyZW50ID0gZiwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hbmltYXRlKGYueCkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5vbkRyYWdFbmQgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLmRpZmZlcmVuY2UodGhpcy5fZHJhZy5wb2ludGVyLCB0aGlzLnBvaW50ZXIoYikpCiAgICAgICAgICAgICAgICAgICAgICAgICwgZSA9IHRoaXMuX2RyYWcuc3RhZ2UuY3VycmVudAogICAgICAgICAgICAgICAgICAgICAgICAsIGYgPSBkLnggPiAwIF4gdGhpcy5zZXR0aW5ncy5ydGwgPyAibGVmdCIgOiAicmlnaHQiOwogICAgICAgICAgICAgICAgICAgIGEoYykub2ZmKCIub3dsLmNvcmUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuZ3JhYkNsYXNzKSwKICAgICAgICAgICAgICAgICAgICAoMCAhPT0gZC54ICYmIHRoaXMuaXMoImRyYWdnaW5nIikgfHwgIXRoaXMuaXMoInZhbGlkIikpICYmICh0aGlzLnNwZWVkKHRoaXMuc2V0dGluZ3MuZHJhZ0VuZFNwZWVkIHx8IHRoaXMuc2V0dGluZ3Muc21hcnRTcGVlZCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudCh0aGlzLmNsb3Nlc3QoZS54LCAwICE9PSBkLnggPyBmIDogdGhpcy5fZHJhZy5kaXJlY3Rpb24pKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbnZhbGlkYXRlKCJwb3NpdGlvbiIpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kcmFnLmRpcmVjdGlvbiA9IGYsCiAgICAgICAgICAgICAgICAgICAgKE1hdGguYWJzKGQueCkgPiAzIHx8IChuZXcgRGF0ZSkuZ2V0VGltZSgpIC0gdGhpcy5fZHJhZy50aW1lID4gMzAwKSAmJiB0aGlzLl9kcmFnLnRhcmdldC5vbmUoImNsaWNrLm93bC5jb3JlIiwgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhMQogICAgICAgICAgICAgICAgICAgIH0pKSwKICAgICAgICAgICAgICAgICAgICB0aGlzLmlzKCJkcmFnZ2luZyIpICYmICh0aGlzLmxlYXZlKCJkcmFnZ2luZyIpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoImRyYWdnZWQiKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmNsb3Nlc3QgPSBmdW5jdGlvbihiLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSAtMQogICAgICAgICAgICAgICAgICAgICAgICAsIGYgPSAzMAogICAgICAgICAgICAgICAgICAgICAgICAsIGcgPSB0aGlzLndpZHRoKCkKICAgICAgICAgICAgICAgICAgICAgICAgLCBoID0gdGhpcy5jb29yZGluYXRlcygpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLmZyZWVEcmFnIHx8IGEuZWFjaChoLCBhLnByb3h5KGZ1bmN0aW9uKGEsIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJsZWZ0IiA9PT0gYyAmJiBiID4gaSAtIGYgJiYgYiA8IGkgKyBmID8gZSA9IGEgOiAicmlnaHQiID09PSBjICYmIGIgPiBpIC0gZyAtIGYgJiYgYiA8IGkgLSBnICsgZiA/IGUgPSBhICsgMSA6IHRoaXMub3AoYiwgIjwiLCBpKSAmJiB0aGlzLm9wKGIsICI+IiwgaFthICsgMV0gIT09IGQgPyBoW2EgKyAxXSA6IGkgLSBnKSAmJiAoZSA9ICJsZWZ0IiA9PT0gYyA/IGEgKyAxIDogYSksCiAgICAgICAgICAgICAgICAgICAgICAgIC0xID09PSBlCiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpLAogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubG9vcCB8fCAodGhpcy5vcChiLCAiPiIsIGhbdGhpcy5taW5pbXVtKCldKSA/IGUgPSBiID0gdGhpcy5taW5pbXVtKCkgOiB0aGlzLm9wKGIsICI8IiwgaFt0aGlzLm1heGltdW0oKV0pICYmIChlID0gYiA9IHRoaXMubWF4aW11bSgpKSksCiAgICAgICAgICAgICAgICAgICAgICAgIGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLnNwZWVkKCkgPiAwOwogICAgICAgICAgICAgICAgICAgIHRoaXMuaXMoImFuaW1hdGluZyIpICYmIHRoaXMub25UcmFuc2l0aW9uRW5kKCksCiAgICAgICAgICAgICAgICAgICAgYyAmJiAodGhpcy5lbnRlcigiYW5pbWF0aW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigidHJhbnNsYXRlIikpLAogICAgICAgICAgICAgICAgICAgICAgICBhLnN1cHBvcnQudHJhbnNmb3JtM2QgJiYgYS5zdXBwb3J0LnRyYW5zaXRpb24gPyB0aGlzLiRzdGFnZS5jc3MoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtOiAidHJhbnNsYXRlM2QoIiArIGIgKyAicHgsMHB4LDBweCkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNpdGlvbjogdGhpcy5zcGVlZCgpIC8gMWUzICsgInMiICsgKHRoaXMuc2V0dGluZ3Muc2xpZGVUcmFuc2l0aW9uID8gIiAiICsgdGhpcy5zZXR0aW5ncy5zbGlkZVRyYW5zaXRpb24gOiAiIikKICAgICAgICAgICAgICAgICAgICAgICAgfSkgOiBjID8gdGhpcy4kc3RhZ2UuYW5pbWF0ZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBiICsgInB4IgogICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnNwZWVkKCksIHRoaXMuc2V0dGluZ3MuZmFsbGJhY2tFYXNpbmcsIGEucHJveHkodGhpcy5vblRyYW5zaXRpb25FbmQsIHRoaXMpKSA6IHRoaXMuJHN0YWdlLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBiICsgInB4IgogICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuaXMgPSBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlcy5jdXJyZW50W2FdICYmIHRoaXMuX3N0YXRlcy5jdXJyZW50W2FdID4gMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuY3VycmVudCA9IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoYSA9PT0gZCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnQ7CiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IHRoaXMuX2l0ZW1zLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQ7CiAgICAgICAgICAgICAgICAgICAgaWYgKGEgPSB0aGlzLm5vcm1hbGl6ZShhKSwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50ICE9PSBhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy50cmlnZ2VyKCJjaGFuZ2UiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICJwb3NpdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGIuZGF0YSAhPT0gZCAmJiAoYSA9IHRoaXMubm9ybWFsaXplKGIuZGF0YSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudCA9IGEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRhdGUoInBvc2l0aW9uIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRyaWdnZXIoImNoYW5nZWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHk6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogInBvc2l0aW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuX2N1cnJlbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY3VycmVudAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuaW52YWxpZGF0ZSA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gInN0cmluZyIgPT09IGEudHlwZShiKSAmJiAodGhpcy5faW52YWxpZGF0ZWRbYl0gPSAhMCwKICAgICAgICAgICAgICAgICAgICB0aGlzLmlzKCJ2YWxpZCIpICYmIHRoaXMubGVhdmUoInZhbGlkIikpLAogICAgICAgICAgICAgICAgICAgICAgICBhLm1hcCh0aGlzLl9pbnZhbGlkYXRlZCwgZnVuY3Rpb24oYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIChhID0gdGhpcy5ub3JtYWxpemUoYSkpICE9PSBkICYmICh0aGlzLl9zcGVlZCA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnQgPSBhLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN1cHByZXNzKFsidHJhbnNsYXRlIiwgInRyYW5zbGF0ZWQiXSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSh0aGlzLmNvb3JkaW5hdGVzKGEpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWxlYXNlKFsidHJhbnNsYXRlIiwgInRyYW5zbGF0ZWQiXSkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5ub3JtYWxpemUgPSBmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLl9pdGVtcy5sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gYiA/IDAgOiB0aGlzLl9jbG9uZXMubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAhdGhpcy5pc051bWVyaWMoYSkgfHwgYyA8IDEgPyBhID0gZCA6IChhIDwgMCB8fCBhID49IGMgKyBlKSAmJiAoYSA9ICgoYSAtIGUgLyAyKSAlIGMgKyBjKSAlIGMgKyBlIC8gMiksCiAgICAgICAgICAgICAgICAgICAgICAgIGEKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnJlbGF0aXZlID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBhIC09IHRoaXMuX2Nsb25lcy5sZW5ndGggLyAyLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vcm1hbGl6ZShhLCAhMCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLm1heGltdW0gPSBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGIsIGMsIGQsIGUgPSB0aGlzLnNldHRpbmdzLCBmID0gdGhpcy5fY29vcmRpbmF0ZXMubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIGlmIChlLmxvb3ApCiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB0aGlzLl9jbG9uZXMubGVuZ3RoIC8gMiArIHRoaXMuX2l0ZW1zLmxlbmd0aCAtIDE7CiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZS5hdXRvV2lkdGggfHwgZS5tZXJnZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYiA9IHRoaXMuX2l0ZW1zLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYyA9IHRoaXMuX2l0ZW1zWy0tYl0ud2lkdGgoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSB0aGlzLiRlbGVtZW50LndpZHRoKCk7IGItLSAmJiAhKChjICs9IHRoaXMuX2l0ZW1zW2JdLndpZHRoKCkgKyB0aGlzLnNldHRpbmdzLm1hcmdpbikgPiBkKTsgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGIgKyAxCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBlLmNlbnRlciA/IHRoaXMuX2l0ZW1zLmxlbmd0aCAtIDEgOiB0aGlzLl9pdGVtcy5sZW5ndGggLSBlLml0ZW1zOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBhICYmIChmIC09IHRoaXMuX2Nsb25lcy5sZW5ndGggLyAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoZiwgMCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLm1pbmltdW0gPSBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgPyAwIDogdGhpcy5fY2xvbmVzLmxlbmd0aCAvIDIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLml0ZW1zID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBhID09PSBkID8gdGhpcy5faXRlbXMuc2xpY2UoKSA6IChhID0gdGhpcy5ub3JtYWxpemUoYSwgITApLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pdGVtc1thXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLm1lcmdlcnMgPSBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEgPT09IGQgPyB0aGlzLl9tZXJnZXJzLnNsaWNlKCkgOiAoYSA9IHRoaXMubm9ybWFsaXplKGEsICEwKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVyZ2Vyc1thXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmNsb25lcyA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuX2Nsb25lcy5sZW5ndGggLyAyCiAgICAgICAgICAgICAgICAgICAgICAgICwgZSA9IGMgKyB0aGlzLl9pdGVtcy5sZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgLCBmID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSAlIDIgPT0gMCA/IGUgKyBhIC8gMiA6IGMgLSAoYSArIDEpIC8gMgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIgPT09IGQgPyBhLm1hcCh0aGlzLl9jbG9uZXMsIGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYoYikKICAgICAgICAgICAgICAgICAgICB9KSA6IGEubWFwKHRoaXMuX2Nsb25lcywgZnVuY3Rpb24oYSwgYykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSA9PT0gYiA/IGYoYykgOiBudWxsCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnNwZWVkID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBhICE9PSBkICYmICh0aGlzLl9zcGVlZCA9IGEpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zcGVlZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuY29vcmRpbmF0ZXMgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGMsIGUgPSAxLCBmID0gYiAtIDE7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIgPT09IGQgPyBhLm1hcCh0aGlzLl9jb29yZGluYXRlcywgYS5wcm94eShmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvb3JkaW5hdGVzKGIpCiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpIDogKHRoaXMuc2V0dGluZ3MuY2VudGVyID8gKHRoaXMuc2V0dGluZ3MucnRsICYmIChlID0gLTEsCiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBiICsgMSksCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSB0aGlzLl9jb29yZGluYXRlc1tiXSwKICAgICAgICAgICAgICAgICAgICAgICAgYyArPSAodGhpcy53aWR0aCgpIC0gYyArICh0aGlzLl9jb29yZGluYXRlc1tmXSB8fCAwKSkgLyAyICogZSkgOiBjID0gdGhpcy5fY29vcmRpbmF0ZXNbZl0gfHwgMCwKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IE1hdGguY2VpbChjKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmR1cmF0aW9uID0gZnVuY3Rpb24oYSwgYiwgYykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAwID09PSBjID8gMCA6IE1hdGgubWluKE1hdGgubWF4KE1hdGguYWJzKGIgLSBhKSwgMSksIDYpICogTWF0aC5hYnMoYyB8fCB0aGlzLnNldHRpbmdzLnNtYXJ0U3BlZWQpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS50byA9IGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IHRoaXMuY3VycmVudCgpCiAgICAgICAgICAgICAgICAgICAgICAgICwgZCA9IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gYSAtIHRoaXMucmVsYXRpdmUoYykKICAgICAgICAgICAgICAgICAgICAgICAgLCBmID0gKGUgPiAwKSAtIChlIDwgMCkKICAgICAgICAgICAgICAgICAgICAgICAgLCBnID0gdGhpcy5faXRlbXMubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICwgaCA9IHRoaXMubWluaW11bSgpCiAgICAgICAgICAgICAgICAgICAgICAgICwgaSA9IHRoaXMubWF4aW11bSgpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubG9vcCA/ICghdGhpcy5zZXR0aW5ncy5yZXdpbmQgJiYgTWF0aC5hYnMoZSkgPiBnIC8gMiAmJiAoZSArPSAtMSAqIGYgKiBnKSwKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGMgKyBlLAogICAgICAgICAgICAgICAgICAgIChkID0gKChhIC0gaCkgJSBnICsgZykgJSBnICsgaCkgIT09IGEgJiYgZCAtIGUgPD0gaSAmJiBkIC0gZSA+IDAgJiYgKGMgPSBkIC0gZSwKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IGQsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXQoYykpKSA6IHRoaXMuc2V0dGluZ3MucmV3aW5kID8gKGkgKz0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IChhICUgaSArIGkpICUgaSkgOiBhID0gTWF0aC5tYXgoaCwgTWF0aC5taW4oaSwgYSkpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNwZWVkKHRoaXMuZHVyYXRpb24oYywgYSwgYikpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnQoYSksCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1Zpc2libGUoKSAmJiB0aGlzLnVwZGF0ZSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIGEgPSBhIHx8ICExLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvKHRoaXMucmVsYXRpdmUodGhpcy5jdXJyZW50KCkpICsgMSwgYSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnByZXYgPSBmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgYSA9IGEgfHwgITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG8odGhpcy5yZWxhdGl2ZSh0aGlzLmN1cnJlbnQoKSkgLSAxLCBhKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUub25UcmFuc2l0aW9uRW5kID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIGlmIChhICE9PSBkICYmIChhLnN0b3BQcm9wYWdhdGlvbigpLAogICAgICAgICAgICAgICAgICAgIChhLnRhcmdldCB8fCBhLnNyY0VsZW1lbnQgfHwgYS5vcmlnaW5hbFRhcmdldCkgIT09IHRoaXMuJHN0YWdlLmdldCgwKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhMTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxlYXZlKCJhbmltYXRpbmciKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCJ0cmFuc2xhdGVkIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnZpZXdwb3J0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5yZXNwb25zaXZlQmFzZUVsZW1lbnQgIT09IGIgPyBkID0gYSh0aGlzLm9wdGlvbnMucmVzcG9uc2l2ZUJhc2VFbGVtZW50KS53aWR0aCgpIDogYi5pbm5lcldpZHRoID8gZCA9IGIuaW5uZXJXaWR0aCA6IGMuZG9jdW1lbnRFbGVtZW50ICYmIGMuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoID8gZCA9IGMuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIDogY29uc29sZS53YXJuKCJDYW4gbm90IGRldGVjdCB2aWV3cG9ydCB3aWR0aC4iKSwKICAgICAgICAgICAgICAgICAgICAgICAgZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUucmVwbGFjZSA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZS5lbXB0eSgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pdGVtcyA9IFtdLAogICAgICAgICAgICAgICAgICAgIGIgJiYgKGIgPSBiIGluc3RhbmNlb2YgalF1ZXJ5ID8gYiA6IGEoYikpLAogICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubmVzdGVkSXRlbVNlbGVjdG9yICYmIChiID0gYi5maW5kKCIuIiArIHRoaXMuc2V0dGluZ3MubmVzdGVkSXRlbVNlbGVjdG9yKSksCiAgICAgICAgICAgICAgICAgICAgICAgIGIuZmlsdGVyKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDEgPT09IHRoaXMubm9kZVR5cGUKICAgICAgICAgICAgICAgICAgICAgICAgfSkuZWFjaChhLnByb3h5KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSB0aGlzLnByZXBhcmUoYiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RhZ2UuYXBwZW5kKGIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2l0ZW1zLnB1c2goYiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVyZ2Vycy5wdXNoKDEgKiBiLmZpbmQoIltkYXRhLW1lcmdlXSIpLmFkZEJhY2soIltkYXRhLW1lcmdlXSIpLmF0dHIoImRhdGEtbWVyZ2UiKSB8fCAxKQogICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXQodGhpcy5pc051bWVyaWModGhpcy5zZXR0aW5ncy5zdGFydFBvc2l0aW9uKSA/IHRoaXMuc2V0dGluZ3Muc3RhcnRQb3NpdGlvbiA6IDApLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRhdGUoIml0ZW1zIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKGIsIGMpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMucmVsYXRpdmUodGhpcy5fY3VycmVudCk7CiAgICAgICAgICAgICAgICAgICAgYyA9IGMgPT09IGQgPyB0aGlzLl9pdGVtcy5sZW5ndGggOiB0aGlzLm5vcm1hbGl6ZShjLCAhMCksCiAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBiIGluc3RhbmNlb2YgalF1ZXJ5ID8gYiA6IGEoYiksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigiYWRkIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICBiID0gdGhpcy5wcmVwYXJlKGIpLAogICAgICAgICAgICAgICAgICAgICAgICAwID09PSB0aGlzLl9pdGVtcy5sZW5ndGggfHwgYyA9PT0gdGhpcy5faXRlbXMubGVuZ3RoID8gKDAgPT09IHRoaXMuX2l0ZW1zLmxlbmd0aCAmJiB0aGlzLiRzdGFnZS5hcHBlbmQoYiksCiAgICAgICAgICAgICAgICAgICAgICAgIDAgIT09IHRoaXMuX2l0ZW1zLmxlbmd0aCAmJiB0aGlzLl9pdGVtc1tjIC0gMV0uYWZ0ZXIoYiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pdGVtcy5wdXNoKGIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVyZ2Vycy5wdXNoKDEgKiBiLmZpbmQoIltkYXRhLW1lcmdlXSIpLmFkZEJhY2soIltkYXRhLW1lcmdlXSIpLmF0dHIoImRhdGEtbWVyZ2UiKSB8fCAxKSkgOiAodGhpcy5faXRlbXNbY10uYmVmb3JlKGIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faXRlbXMuc3BsaWNlKGMsIDAsIGIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVyZ2Vycy5zcGxpY2UoYywgMCwgMSAqIGIuZmluZCgiW2RhdGEtbWVyZ2VdIikuYWRkQmFjaygiW2RhdGEtbWVyZ2VdIikuYXR0cigiZGF0YS1tZXJnZSIpIHx8IDEpKSwKICAgICAgICAgICAgICAgICAgICB0aGlzLl9pdGVtc1tlXSAmJiB0aGlzLnJlc2V0KHRoaXMuX2l0ZW1zW2VdLmluZGV4KCkpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRhdGUoIml0ZW1zIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcigiYWRkZWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGMKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAoYSA9IHRoaXMubm9ybWFsaXplKGEsICEwKSkgIT09IGQgJiYgKHRoaXMudHJpZ2dlcigicmVtb3ZlIiwgewogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiB0aGlzLl9pdGVtc1thXSwKICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGEKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faXRlbXNbYV0ucmVtb3ZlKCksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2l0ZW1zLnNwbGljZShhLCAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVyZ2Vycy5zcGxpY2UoYSwgMSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZGF0ZSgiaXRlbXMiKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCJyZW1vdmVkIiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBhCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUucHJlbG9hZEF1dG9XaWR0aEltYWdlcyA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICBiLmVhY2goYS5wcm94eShmdW5jdGlvbihiLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW50ZXIoInByZS1sb2FkaW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gYShjKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEobmV3IEltYWdlKS5vbmUoImxvYWQiLCBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLmF0dHIoInNyYyIsIGEudGFyZ2V0LnNyYyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuY3NzKCJvcGFjaXR5IiwgMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGVhdmUoInByZS1sb2FkaW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRoaXMuaXMoInByZS1sb2FkaW5nIikgJiYgIXRoaXMuaXMoImluaXRpYWxpemluZyIpICYmIHRoaXMucmVmcmVzaCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSkuYXR0cigic3JjIiwgYy5hdHRyKCJzcmMiKSB8fCBjLmF0dHIoImRhdGEtc3JjIikgfHwgYy5hdHRyKCJkYXRhLXNyYy1yZXRpbmEiKSkKICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50Lm9mZigiLm93bC5jb3JlIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHN0YWdlLm9mZigiLm93bC5jb3JlIiksCiAgICAgICAgICAgICAgICAgICAgICAgIGEoYykub2ZmKCIub3dsLmNvcmUiKSwKICAgICAgICAgICAgICAgICAgICAhMSAhPT0gdGhpcy5zZXR0aW5ncy5yZXNwb25zaXZlICYmIChiLmNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZVRpbWVyKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vZmYoYiwgInJlc2l6ZSIsIHRoaXMuX2hhbmRsZXJzLm9uVGhyb3R0bGVkUmVzaXplKSk7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCBpbiB0aGlzLl9wbHVnaW5zKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbHVnaW5zW2RdLmRlc3Ryb3koKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZS5jaGlsZHJlbigiLmNsb25lZCIpLnJlbW92ZSgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZS51bndyYXAoKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RhZ2UuY2hpbGRyZW4oKS5jb250ZW50cygpLnVud3JhcCgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZS5jaGlsZHJlbigpLnVud3JhcCgpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdGFnZS5yZW1vdmUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZWxlbWVudC5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMucmVmcmVzaENsYXNzKS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGluZ0NsYXNzKS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMubG9hZGVkQ2xhc3MpLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5ydGxDbGFzcykucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmRyYWdDbGFzcykucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLmdyYWJDbGFzcykuYXR0cigiY2xhc3MiLCB0aGlzLiRlbGVtZW50LmF0dHIoImNsYXNzIikucmVwbGFjZShuZXcgUmVnRXhwKHRoaXMub3B0aW9ucy5yZXNwb25zaXZlQ2xhc3MgKyAiLVxcUytcXHMiLCJnIiksICIiKSkucmVtb3ZlRGF0YSgib3dsLmNhcm91c2VsIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLm9wID0gZnVuY3Rpb24oYSwgYiwgYykgewogICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5zZXR0aW5ncy5ydGw7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIjwiOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQgPyBhID4gYyA6IGEgPCBjOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICI+IjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkID8gYSA8IGMgOiBhID4gYzsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiPj0iOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQgPyBhIDw9IGMgOiBhID49IGM7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIjw9IjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkID8gYSA+PSBjIDogYSA8PSBjCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUub24gPSBmdW5jdGlvbihhLCBiLCBjLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgYS5hZGRFdmVudExpc3RlbmVyID8gYS5hZGRFdmVudExpc3RlbmVyKGIsIGMsIGQpIDogYS5hdHRhY2hFdmVudCAmJiBhLmF0dGFjaEV2ZW50KCJvbiIgKyBiLCBjKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24oYSwgYiwgYywgZCkgewogICAgICAgICAgICAgICAgICAgIGEucmVtb3ZlRXZlbnRMaXN0ZW5lciA/IGEucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLCBjLCBkKSA6IGEuZGV0YWNoRXZlbnQgJiYgYS5kZXRhY2hFdmVudCgib24iICsgYiwgYykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbihiLCBjLCBkLCBmLCBnKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW06IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50OiB0aGlzLl9pdGVtcy5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogdGhpcy5jdXJyZW50KCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLCBpID0gYS5jYW1lbENhc2UoYS5ncmVwKFsib24iLCBiLCBkXSwgZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYQogICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oIi0iKS50b0xvd2VyQ2FzZSgpKQogICAgICAgICAgICAgICAgICAgICAgICAsIGogPSBhLkV2ZW50KFtiLCAib3dsIiwgZCB8fCAiY2Fyb3VzZWwiXS5qb2luKCIuIikudG9Mb3dlckNhc2UoKSwgYS5leHRlbmQoewogICAgICAgICAgICAgICAgICAgICAgICByZWxhdGVkVGFyZ2V0OiB0aGlzCiAgICAgICAgICAgICAgICAgICAgfSwgaCwgYykpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdXByZXNzW2JdIHx8IChhLmVhY2godGhpcy5fcGx1Z2lucywgZnVuY3Rpb24oYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICBiLm9uVHJpZ2dlciAmJiBiLm9uVHJpZ2dlcihqKQogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IGUuVHlwZS5FdmVudCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGIKICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihqKSwKICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIHRoaXMuc2V0dGluZ3NbaV0gJiYgdGhpcy5zZXR0aW5nc1tpXS5jYWxsKHRoaXMsIGopKSwKICAgICAgICAgICAgICAgICAgICAgICAgagogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuZW50ZXIgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgYS5lYWNoKFtiXS5jb25jYXQodGhpcy5fc3RhdGVzLnRhZ3NbYl0gfHwgW10pLCBhLnByb3h5KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGVzLmN1cnJlbnRbYl0gPT09IGQgJiYgKHRoaXMuX3N0YXRlcy5jdXJyZW50W2JdID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZXMuY3VycmVudFtiXSsrCiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5sZWF2ZSA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICBhLmVhY2goW2JdLmNvbmNhdCh0aGlzLl9zdGF0ZXMudGFnc1tiXSB8fCBbXSksIGEucHJveHkoZnVuY3Rpb24oYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZXMuY3VycmVudFtiXS0tCiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoYi50eXBlID09PSBlLlR5cGUuRXZlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEuZXZlbnQuc3BlY2lhbFtiLm5hbWVdIHx8IChhLmV2ZW50LnNwZWNpYWxbYi5uYW1lXSA9IHt9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICFhLmV2ZW50LnNwZWNpYWxbYi5uYW1lXS5vd2wpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gYS5ldmVudC5zcGVjaWFsW2IubmFtZV0uX2RlZmF1bHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmV2ZW50LnNwZWNpYWxbYi5uYW1lXS5fZGVmYXVsdCA9IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWMgfHwgIWMuYXBwbHkgfHwgYS5uYW1lc3BhY2UgJiYgLTEgIT09IGEubmFtZXNwYWNlLmluZGV4T2YoIm93bCIpID8gYS5uYW1lc3BhY2UgJiYgYS5uYW1lc3BhY2UuaW5kZXhPZigib3dsIikgPiAtMSA6IGMuYXBwbHkodGhpcywgYXJndW1lbnRzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmV2ZW50LnNwZWNpYWxbYi5uYW1lXS5vd2wgPSAhMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIGIudHlwZSA9PT0gZS5UeXBlLlN0YXRlICYmICh0aGlzLl9zdGF0ZXMudGFnc1tiLm5hbWVdID8gdGhpcy5fc3RhdGVzLnRhZ3NbYi5uYW1lXSA9IHRoaXMuX3N0YXRlcy50YWdzW2IubmFtZV0uY29uY2F0KGIudGFncykgOiB0aGlzLl9zdGF0ZXMudGFnc1tiLm5hbWVdID0gYi50YWdzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdGVzLnRhZ3NbYi5uYW1lXSA9IGEuZ3JlcCh0aGlzLl9zdGF0ZXMudGFnc1tiLm5hbWVdLCBhLnByb3h5KGZ1bmN0aW9uKGMsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5pbkFycmF5KGMsIHRoaXMuX3N0YXRlcy50YWdzW2IubmFtZV0pID09PSBkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5zdXBwcmVzcyA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICBhLmVhY2goYiwgYS5wcm94eShmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1cHJlc3NbYl0gPSAhMAogICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUucmVsZWFzZSA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICBhLmVhY2goYiwgYS5wcm94eShmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9zdXByZXNzW2JdCiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5wb2ludGVyID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIHZhciBjID0gewogICAgICAgICAgICAgICAgICAgICAgICB4OiBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB5OiBudWxsCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSA9IGEub3JpZ2luYWxFdmVudCB8fCBhIHx8IGIuZXZlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBhLnRvdWNoZXMgJiYgYS50b3VjaGVzLmxlbmd0aCA/IGEudG91Y2hlc1swXSA6IGEuY2hhbmdlZFRvdWNoZXMgJiYgYS5jaGFuZ2VkVG91Y2hlcy5sZW5ndGggPyBhLmNoYW5nZWRUb3VjaGVzWzBdIDogYSwKICAgICAgICAgICAgICAgICAgICAgICAgYS5wYWdlWCA/IChjLnggPSBhLnBhZ2VYLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYy55ID0gYS5wYWdlWSkgOiAoYy54ID0gYS5jbGllbnRYLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYy55ID0gYS5jbGllbnRZKSwKICAgICAgICAgICAgICAgICAgICAgICAgYwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuaXNOdW1lcmljID0gZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAhaXNOYU4ocGFyc2VGbG9hdChhKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmRpZmZlcmVuY2UgPSBmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgeDogYS54IC0gYi54LAogICAgICAgICAgICAgICAgICAgICAgICB5OiBhLnkgLSBiLnkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBhLmZuLm93bENhcm91c2VsID0gZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICAgIHZhciBjID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGEodGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZiA9IGQuZGF0YSgib3dsLmNhcm91c2VsIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGYgfHwgKGYgPSBuZXcgZSh0aGlzLCJvYmplY3QiID09IHR5cGVvZiBiICYmIGIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5kYXRhKCJvd2wuY2Fyb3VzZWwiLCBmKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEuZWFjaChbIm5leHQiLCAicHJldiIsICJ0byIsICJkZXN0cm95IiwgInJlZnJlc2giLCAicmVwbGFjZSIsICJhZGQiLCAicmVtb3ZlIl0sIGZ1bmN0aW9uKGIsIGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLnJlZ2lzdGVyKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogZS5UeXBlLkV2ZW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBjCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuJGVsZW1lbnQub24oYyArICIub3dsLmNhcm91c2VsLmNvcmUiLCBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubmFtZXNwYWNlICYmIGEucmVsYXRlZFRhcmdldCAhPT0gdGhpcyAmJiAodGhpcy5zdXBwcmVzcyhbY10pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZbY10uYXBwbHkodGhpcywgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbGVhc2UoW2NdKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSksCiAgICAgICAgICAgICAgICAgICAgICAgICJzdHJpbmciID09IHR5cGVvZiBiICYmICJfIiAhPT0gYi5jaGFyQXQoMCkgJiYgZltiXS5hcHBseShmLCBjKQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICBhLmZuLm93bENhcm91c2VsLkNvbnN0cnVjdG9yID0gZQogICAgICAgIH0od2luZG93LlplcHRvIHx8IHdpbmRvdy5qUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpLAogICAgICAgICAgICBmdW5jdGlvbihhLCBiLCBjLCBkKSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlID0gYiwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW50ZXJ2YWwgPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92aXNpYmxlID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaW5pdGlhbGl6ZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5uYW1lc3BhY2UgJiYgdGhpcy5fY29yZS5zZXR0aW5ncy5hdXRvUmVmcmVzaCAmJiB0aGlzLndhdGNoKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUub3B0aW9ucyA9IGEuZXh0ZW5kKHt9LCBlLkRlZmF1bHRzLCB0aGlzLl9jb3JlLm9wdGlvbnMpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLiRlbGVtZW50Lm9uKHRoaXMuX2hhbmRsZXJzKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGUuRGVmYXVsdHMgPSB7CiAgICAgICAgICAgICAgICAgICAgYXV0b1JlZnJlc2g6ICEwLAogICAgICAgICAgICAgICAgICAgIGF1dG9SZWZyZXNoSW50ZXJ2YWw6IDUwMAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS53YXRjaCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcnZhbCB8fCAodGhpcy5fdmlzaWJsZSA9IHRoaXMuX2NvcmUuaXNWaXNpYmxlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcnZhbCA9IGIuc2V0SW50ZXJ2YWwoYS5wcm94eSh0aGlzLnJlZnJlc2gsIHRoaXMpLCB0aGlzLl9jb3JlLnNldHRpbmdzLmF1dG9SZWZyZXNoSW50ZXJ2YWwpKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgZS5wcm90b3R5cGUucmVmcmVzaCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLmlzVmlzaWJsZSgpICE9PSB0aGlzLl92aXNpYmxlICYmICh0aGlzLl92aXNpYmxlID0gIXRoaXMuX3Zpc2libGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLiRlbGVtZW50LnRvZ2dsZUNsYXNzKCJvd2wtaGlkZGVuIiwgIXRoaXMuX3Zpc2libGUpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92aXNpYmxlICYmIHRoaXMuX2NvcmUuaW52YWxpZGF0ZSgid2lkdGgiKSAmJiB0aGlzLl9jb3JlLnJlZnJlc2goKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEsIGM7CiAgICAgICAgICAgICAgICAgICAgICAgIGIuY2xlYXJJbnRlcnZhbCh0aGlzLl9pbnRlcnZhbCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYSBpbiB0aGlzLl9oYW5kbGVycykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuJGVsZW1lbnQub2ZmKGEsIHRoaXMuX2hhbmRsZXJzW2FdKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjIGluIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImZ1bmN0aW9uIiAhPSB0eXBlb2YgdGhpc1tjXSAmJiAodGhpc1tjXSA9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBhLmZuLm93bENhcm91c2VsLkNvbnN0cnVjdG9yLlBsdWdpbnMuQXV0b1JlZnJlc2ggPSBlCiAgICAgICAgICAgIH0od2luZG93LlplcHRvIHx8IHdpbmRvdy5qUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpLAogICAgICAgICAgICBmdW5jdGlvbihhLCBiLCBjLCBkKSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlID0gYiwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVkID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXJzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImluaXRpYWxpemVkLm93bC5jYXJvdXNlbCBjaGFuZ2Uub3dsLmNhcm91c2VsIHJlc2l6ZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIubmFtZXNwYWNlICYmIHRoaXMuX2NvcmUuc2V0dGluZ3MgJiYgdGhpcy5fY29yZS5zZXR0aW5ncy5sYXp5TG9hZCAmJiAoYi5wcm9wZXJ0eSAmJiAicG9zaXRpb24iID09IGIucHJvcGVydHkubmFtZSB8fCAiaW5pdGlhbGl6ZWQiID09IGIudHlwZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSB0aGlzLl9jb3JlLnNldHRpbmdzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGUgPSBjLmNlbnRlciAmJiBNYXRoLmNlaWwoYy5pdGVtcyAvIDIpIHx8IGMuaXRlbXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZiA9IGMuY2VudGVyICYmIC0xICogZSB8fCAwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGcgPSAoYi5wcm9wZXJ0eSAmJiBiLnByb3BlcnR5LnZhbHVlICE9PSBkID8gYi5wcm9wZXJ0eS52YWx1ZSA6IHRoaXMuX2NvcmUuY3VycmVudCgpKSArIGYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgaCA9IHRoaXMuX2NvcmUuY2xvbmVzKCkubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGkgPSBhLnByb3h5KGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZChiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjLmxhenlMb2FkRWFnZXIgPiAwICYmIChlICs9IGMubGF6eUxvYWRFYWdlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5sb29wICYmIChnIC09IGMubGF6eUxvYWRFYWdlciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUrKykpOyBmKysgPCBlOyApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQoaCAvIDIgKyB0aGlzLl9jb3JlLnJlbGF0aXZlKGcpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGggJiYgYS5lYWNoKHRoaXMuX2NvcmUuY2xvbmVzKHRoaXMuX2NvcmUucmVsYXRpdmUoZykpLCBpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnKysKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLm9wdGlvbnMgPSBhLmV4dGVuZCh7fSwgZS5EZWZhdWx0cywgdGhpcy5fY29yZS5vcHRpb25zKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS4kZWxlbWVudC5vbih0aGlzLl9oYW5kbGVycykKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBlLkRlZmF1bHRzID0gewogICAgICAgICAgICAgICAgICAgIGxhenlMb2FkOiAhMSwKICAgICAgICAgICAgICAgICAgICBsYXp5TG9hZEVhZ2VyOiAwCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkID0gdGhpcy5fY29yZS4kc3RhZ2UuY2hpbGRyZW4oKS5lcShjKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gZCAmJiBkLmZpbmQoIi5vd2wtbGF6eSIpOwogICAgICAgICAgICAgICAgICAgICAgICAhZSB8fCBhLmluQXJyYXkoZC5nZXQoMCksIHRoaXMuX2xvYWRlZCkgPiAtMSB8fCAoZS5lYWNoKGEucHJveHkoZnVuY3Rpb24oYywgZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUsIGYgPSBhKGQpLCBnID0gYi5kZXZpY2VQaXhlbFJhdGlvID4gMSAmJiBmLmF0dHIoImRhdGEtc3JjLXJldGluYSIpIHx8IGYuYXR0cigiZGF0YS1zcmMiKSB8fCBmLmF0dHIoImRhdGEtc3Jjc2V0Iik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnRyaWdnZXIoImxvYWQiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGcKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sICJsYXp5IiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5pcygiaW1nIikgPyBmLm9uZSgibG9hZC5vd2wubGF6eSIsIGEucHJveHkoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuY3NzKCJvcGFjaXR5IiwgMSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnRyaWdnZXIoImxvYWRlZCIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiBmLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgImxhenkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKS5hdHRyKCJzcmMiLCBnKSA6IGYuaXMoInNvdXJjZSIpID8gZi5vbmUoImxvYWQub3dsLmxhenkiLCBhLnByb3h5KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnRyaWdnZXIoImxvYWRlZCIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQ6IGYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgImxhenkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKS5hdHRyKCJzcmNzZXQiLCBnKSA6IChlID0gbmV3IEltYWdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLm9ubG9hZCA9IGEucHJveHkoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImJhY2tncm91bmQtaW1hZ2UiOiAndXJsKCInICsgZyArICciKScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogIjEiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnRyaWdnZXIoImxvYWRlZCIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogZiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgImxhenkiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5zcmMgPSBnKQogICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZWQucHVzaChkLmdldCgwKSkpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhLCBiOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgaW4gdGhpcy5oYW5kbGVycykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuJGVsZW1lbnQub2ZmKGEsIHRoaXMuaGFuZGxlcnNbYV0pOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGIgaW4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZnVuY3Rpb24iICE9IHR5cGVvZiB0aGlzW2JdICYmICh0aGlzW2JdID0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGEuZm4ub3dsQ2Fyb3VzZWwuQ29uc3RydWN0b3IuUGx1Z2lucy5MYXp5ID0gZQogICAgICAgICAgICB9KHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KSwKICAgICAgICAgICAgZnVuY3Rpb24oYSwgYiwgYywgZCkgewogICAgICAgICAgICAgICAgdmFyIGUgPSBmdW5jdGlvbihjKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZSA9IGMsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ByZXZpb3VzSGVpZ2h0ID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaW5pdGlhbGl6ZWQub3dsLmNhcm91c2VsIHJlZnJlc2hlZC5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5hbWVzcGFjZSAmJiB0aGlzLl9jb3JlLnNldHRpbmdzLmF1dG9IZWlnaHQgJiYgdGhpcy51cGRhdGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2hhbmdlZC5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5hbWVzcGFjZSAmJiB0aGlzLl9jb3JlLnNldHRpbmdzLmF1dG9IZWlnaHQgJiYgInBvc2l0aW9uIiA9PT0gYS5wcm9wZXJ0eS5uYW1lICYmIHRoaXMudXBkYXRlKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImxvYWRlZC5vd2wubGF6eSI6IGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubmFtZXNwYWNlICYmIHRoaXMuX2NvcmUuc2V0dGluZ3MuYXV0b0hlaWdodCAmJiBhLmVsZW1lbnQuY2xvc2VzdCgiLiIgKyB0aGlzLl9jb3JlLnNldHRpbmdzLml0ZW1DbGFzcykuaW5kZXgoKSA9PT0gdGhpcy5fY29yZS5jdXJyZW50KCkgJiYgdGhpcy51cGRhdGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcykKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS5vcHRpb25zID0gYS5leHRlbmQoe30sIGUuRGVmYXVsdHMsIHRoaXMuX2NvcmUub3B0aW9ucyksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuJGVsZW1lbnQub24odGhpcy5faGFuZGxlcnMpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcnZhbElkID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IHRoaXM7CiAgICAgICAgICAgICAgICAgICAgYShiKS5vbigibG9hZCIsIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICBkLl9jb3JlLnNldHRpbmdzLmF1dG9IZWlnaHQgJiYgZC51cGRhdGUoKQogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICBhKGIpLnJlc2l6ZShmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQuX2NvcmUuc2V0dGluZ3MuYXV0b0hlaWdodCAmJiAobnVsbCAhPSBkLl9pbnRlcnZhbElkICYmIGNsZWFyVGltZW91dChkLl9pbnRlcnZhbElkKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkLl9pbnRlcnZhbElkID0gc2V0VGltZW91dChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC51cGRhdGUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDI1MCkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgZS5EZWZhdWx0cyA9IHsKICAgICAgICAgICAgICAgICAgICBhdXRvSGVpZ2h0OiAhMSwKICAgICAgICAgICAgICAgICAgICBhdXRvSGVpZ2h0Q2xhc3M6ICJvd2wtaGVpZ2h0IgogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLl9jb3JlLl9jdXJyZW50CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGMgPSBiICsgdGhpcy5fY29yZS5zZXR0aW5ncy5pdGVtcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBkID0gdGhpcy5fY29yZS5zZXR0aW5ncy5sYXp5TG9hZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gdGhpcy5fY29yZS4kc3RhZ2UuY2hpbGRyZW4oKS50b0FycmF5KCkuc2xpY2UoYiwgYykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZiA9IFtdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGcgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICBhLmVhY2goZSwgZnVuY3Rpb24oYiwgYykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZi5wdXNoKGEoYykuaGVpZ2h0KCkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IE1hdGgubWF4LmFwcGx5KG51bGwsIGYpLAogICAgICAgICAgICAgICAgICAgICAgICBnIDw9IDEgJiYgZCAmJiB0aGlzLl9wcmV2aW91c0hlaWdodCAmJiAoZyA9IHRoaXMuX3ByZXZpb3VzSGVpZ2h0KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ByZXZpb3VzSGVpZ2h0ID0gZywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuJHN0YWdlLnBhcmVudCgpLmhlaWdodChnKS5hZGRDbGFzcyh0aGlzLl9jb3JlLnNldHRpbmdzLmF1dG9IZWlnaHRDbGFzcykKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEsIGI7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYSBpbiB0aGlzLl9oYW5kbGVycykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuJGVsZW1lbnQub2ZmKGEsIHRoaXMuX2hhbmRsZXJzW2FdKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChiIGluIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgImZ1bmN0aW9uIiAhPSB0eXBlb2YgdGhpc1tiXSAmJiAodGhpc1tiXSA9IG51bGwpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBhLmZuLm93bENhcm91c2VsLkNvbnN0cnVjdG9yLlBsdWdpbnMuQXV0b0hlaWdodCA9IGUKICAgICAgICAgICAgfSh3aW5kb3cuWmVwdG8gfHwgd2luZG93LmpRdWVyeSwgd2luZG93LCBkb2N1bWVudCksCiAgICAgICAgICAgIGZ1bmN0aW9uKGEsIGIsIGMsIGQpIHsKICAgICAgICAgICAgICAgIHZhciBlID0gZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUgPSBiLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92aWRlb3MgPSB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxheWluZyA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXJzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImluaXRpYWxpemVkLm93bC5jYXJvdXNlbCI6IGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubmFtZXNwYWNlICYmIHRoaXMuX2NvcmUucmVnaXN0ZXIoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAic3RhdGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAicGxheWluZyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhZ3M6IFsiaW50ZXJhY3RpbmciXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZXNpemUub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5uYW1lc3BhY2UgJiYgdGhpcy5fY29yZS5zZXR0aW5ncy52aWRlbyAmJiB0aGlzLmlzSW5GdWxsU2NyZWVuKCkgJiYgYS5wcmV2ZW50RGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZWZyZXNoZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5uYW1lc3BhY2UgJiYgdGhpcy5fY29yZS5pcygicmVzaXppbmciKSAmJiB0aGlzLl9jb3JlLiRzdGFnZS5maW5kKCIuY2xvbmVkIC5vd2wtdmlkZW8tZnJhbWUiKS5yZW1vdmUoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiY2hhbmdlZC5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5hbWVzcGFjZSAmJiAicG9zaXRpb24iID09PSBhLnByb3BlcnR5Lm5hbWUgJiYgdGhpcy5fcGxheWluZyAmJiB0aGlzLnN0b3AoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicHJlcGFyZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIubmFtZXNwYWNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gYShiLmNvbnRlbnQpLmZpbmQoIi5vd2wtdmlkZW8iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5sZW5ndGggJiYgKGMuY3NzKCJkaXNwbGF5IiwgIm5vbmUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmV0Y2goYywgYShiLmNvbnRlbnQpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLm9wdGlvbnMgPSBhLmV4dGVuZCh7fSwgZS5EZWZhdWx0cywgdGhpcy5fY29yZS5vcHRpb25zKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS4kZWxlbWVudC5vbih0aGlzLl9oYW5kbGVycyksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuJGVsZW1lbnQub24oImNsaWNrLm93bC52aWRlbyIsICIub3dsLXZpZGVvLXBsYXktaWNvbiIsIGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5KGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGUuRGVmYXVsdHMgPSB7CiAgICAgICAgICAgICAgICAgICAgdmlkZW86ICExLAogICAgICAgICAgICAgICAgICAgIHZpZGVvSGVpZ2h0OiAhMSwKICAgICAgICAgICAgICAgICAgICB2aWRlb1dpZHRoOiAhMQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5mZXRjaCA9IGZ1bmN0aW9uKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmF0dHIoImRhdGEtdmltZW8taWQiKSA/ICJ2aW1lbyIgOiBhLmF0dHIoImRhdGEtdnphYXItaWQiKSA/ICJ2emFhciIgOiAieW91dHViZSIKICAgICAgICAgICAgICAgICAgICAgICAgfSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGQgPSBhLmF0dHIoImRhdGEtdmltZW8taWQiKSB8fCBhLmF0dHIoImRhdGEteW91dHViZS1pZCIpIHx8IGEuYXR0cigiZGF0YS12emFhci1pZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGUgPSBhLmF0dHIoImRhdGEtd2lkdGgiKSB8fCB0aGlzLl9jb3JlLnNldHRpbmdzLnZpZGVvV2lkdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZiA9IGEuYXR0cigiZGF0YS1oZWlnaHQiKSB8fCB0aGlzLl9jb3JlLnNldHRpbmdzLnZpZGVvSGVpZ2h0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsIGcgPSBhLmF0dHIoImhyZWYiKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJNaXNzaW5nIHZpZGVvIFVSTC4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGQgPSBnLm1hdGNoKC8oaHR0cDp8aHR0cHM6fClcL1wvKHBsYXllci58d3d3LnxhcHAuKT8odmltZW9cLmNvbXx5b3V0dShiZVwuY29tfFwuYmV8YmVcLmdvb2dsZWFwaXNcLmNvbXxiZVwtbm9jb29raWVcLmNvbSl8dnphYXJcLmNvbSlcLyh2aWRlb1wvfHZpZGVvc1wvfGVtYmVkXC98Y2hhbm5lbHNcLy4rXC98Z3JvdXBzXC8uK1wvfHdhdGNoXD92PXx2XC8pPyhbQS1aYS16MC05Ll8lLV0qKShcJlxTKyk/LyksCiAgICAgICAgICAgICAgICAgICAgICAgIGRbM10uaW5kZXhPZigieW91dHUiKSA+IC0xKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9ICJ5b3V0dWJlIjsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoZFszXS5pbmRleE9mKCJ2aW1lbyIpID4gLTEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gInZpbWVvIjsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkWzNdLmluZGV4T2YoInZ6YWFyIikgPiAtMSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJWaWRlbyBVUkwgbm90IHN1cHBvcnRlZC4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAidnphYXIiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGRbNl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl92aWRlb3NbZ10gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogYywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGYKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmF0dHIoImRhdGEtdmlkZW8iLCBnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGh1bWJuYWlsKGEsIHRoaXMuX3ZpZGVvc1tnXSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnRodW1ibmFpbCA9IGZ1bmN0aW9uKGIsIGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQsIGUsIGYsIGcgPSBjLndpZHRoICYmIGMuaGVpZ2h0ID8gIndpZHRoOiIgKyBjLndpZHRoICsgInB4O2hlaWdodDoiICsgYy5oZWlnaHQgKyAicHg7IiA6ICIiLCBoID0gYi5maW5kKCJpbWciKSwgaSA9ICJzcmMiLCBqID0gIiIsIGsgPSB0aGlzLl9jb3JlLnNldHRpbmdzLCBsID0gZnVuY3Rpb24oYykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9ICc8ZGl2IGNsYXNzPSJvd2wtdmlkZW8tcGxheS1pY29uIj48L2Rpdj4nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBrLmxhenlMb2FkID8gYSgiPGRpdi8+IiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogIm93bC12aWRlby10biAiICsgaiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjVHlwZTogYwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pIDogYSgiPGRpdi8+IiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzczogIm93bC12aWRlby10biIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiAib3BhY2l0eToxO2JhY2tncm91bmQtaW1hZ2U6dXJsKCIgKyBjICsgIikiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5hZnRlcihkKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmFmdGVyKGUpCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiLndyYXAoYSgiPGRpdi8+IiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3M6ICJvd2wtdmlkZW8td3JhcHBlciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZTogZwogICAgICAgICAgICAgICAgICAgICAgICB9KSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuc2V0dGluZ3MubGF6eUxvYWQgJiYgKGkgPSAiZGF0YS1zcmMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9ICJvd2wtbGF6eSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaC5sZW5ndGgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbChoLmF0dHIoaSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgucmVtb3ZlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgITE7CiAgICAgICAgICAgICAgICAgICAgICAgICJ5b3V0dWJlIiA9PT0gYy50eXBlID8gKGYgPSAiLy9pbWcueW91dHViZS5jb20vdmkvIiArIGMuaWQgKyAiL2hxZGVmYXVsdC5qcGciLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbChmKSkgOiAidmltZW8iID09PSBjLnR5cGUgPyBhLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogIkdFVCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6ICIvL3ZpbWVvLmNvbS9hcGkvdjIvdmlkZW8vIiArIGMuaWQgKyAiLmpzb24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAganNvbnA6ICJjYWxsYmFjayIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb25wIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gYVswXS50aHVtYm5haWxfbGFyZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwoZikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSkgOiAidnphYXIiID09PSBjLnR5cGUgJiYgYS5hamF4KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJHRVQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAiLy92emFhci5jb20vYXBpL3ZpZGVvcy8iICsgYy5pZCArICIuanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBqc29ucDogImNhbGxiYWNrIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbnAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBhLmZyYW1lZ3JhYl91cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwoZikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS50cmlnZ2VyKCJzdG9wIiwgbnVsbCwgInZpZGVvIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5aW5nLmZpbmQoIi5vd2wtdmlkZW8tZnJhbWUiKS5yZW1vdmUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BsYXlpbmcucmVtb3ZlQ2xhc3MoIm93bC12aWRlby1wbGF5aW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5aW5nID0gbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUubGVhdmUoInBsYXlpbmciKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUudHJpZ2dlcigic3RvcHBlZCIsIG51bGwsICJ2aWRlbyIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYywgZCA9IGEoYi50YXJnZXQpLCBlID0gZC5jbG9zZXN0KCIuIiArIHRoaXMuX2NvcmUuc2V0dGluZ3MuaXRlbUNsYXNzKSwgZiA9IHRoaXMuX3ZpZGVvc1tlLmF0dHIoImRhdGEtdmlkZW8iKV0sIGcgPSBmLndpZHRoIHx8ICIxMDAlIiwgaCA9IGYuaGVpZ2h0IHx8IHRoaXMuX2NvcmUuJHN0YWdlLmhlaWdodCgpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wbGF5aW5nIHx8ICh0aGlzLl9jb3JlLmVudGVyKCJwbGF5aW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnRyaWdnZXIoInBsYXkiLCBudWxsLCAidmlkZW8iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0aGlzLl9jb3JlLml0ZW1zKHRoaXMuX2NvcmUucmVsYXRpdmUoZS5pbmRleCgpKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnJlc2V0KGUuaW5kZXgoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gYSgnPGlmcmFtZSBmcmFtZWJvcmRlcj0iMCIgYWxsb3dmdWxsc2NyZWVuIG1vemFsbG93ZnVsbHNjcmVlbiB3ZWJraXRBbGxvd0Z1bGxTY3JlZW4gPjwvaWZyYW1lPicpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYy5hdHRyKCJoZWlnaHQiLCBoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuYXR0cigid2lkdGgiLCBnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ5b3V0dWJlIiA9PT0gZi50eXBlID8gYy5hdHRyKCJzcmMiLCAiLy93d3cueW91dHViZS5jb20vZW1iZWQvIiArIGYuaWQgKyAiP2F1dG9wbGF5PTEmcmVsPTAmdj0iICsgZi5pZCkgOiAidmltZW8iID09PSBmLnR5cGUgPyBjLmF0dHIoInNyYyIsICIvL3BsYXllci52aW1lby5jb20vdmlkZW8vIiArIGYuaWQgKyAiP2F1dG9wbGF5PTEiKSA6ICJ2emFhciIgPT09IGYudHlwZSAmJiBjLmF0dHIoInNyYyIsICIvL3ZpZXcudnphYXIuY29tLyIgKyBmLmlkICsgIi9wbGF5ZXI/YXV0b3BsYXk9dHJ1ZSIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYShjKS53cmFwKCc8ZGl2IGNsYXNzPSJvd2wtdmlkZW8tZnJhbWUiIC8+JykuaW5zZXJ0QWZ0ZXIoZS5maW5kKCIub3dsLXZpZGVvIikpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGxheWluZyA9IGUuYWRkQ2xhc3MoIm93bC12aWRlby1wbGF5aW5nIikpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5pc0luRnVsbFNjcmVlbiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGMuZnVsbHNjcmVlbkVsZW1lbnQgfHwgYy5tb3pGdWxsU2NyZWVuRWxlbWVudCB8fCBjLndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYiAmJiBhKGIpLnBhcmVudCgpLmhhc0NsYXNzKCJvd2wtdmlkZW8tZnJhbWUiKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSwgYjsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS4kZWxlbWVudC5vZmYoImNsaWNrLm93bC52aWRlbyIpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgaW4gdGhpcy5faGFuZGxlcnMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLiRlbGVtZW50Lm9mZihhLCB0aGlzLl9oYW5kbGVyc1thXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYiBpbiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmdW5jdGlvbiIgIT0gdHlwZW9mIHRoaXNbYl0gJiYgKHRoaXNbYl0gPSBudWxsKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgYS5mbi5vd2xDYXJvdXNlbC5Db25zdHJ1Y3Rvci5QbHVnaW5zLlZpZGVvID0gZQogICAgICAgICAgICB9KHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KSwKICAgICAgICAgICAgZnVuY3Rpb24oYSwgYiwgYywgZCkgewogICAgICAgICAgICAgICAgdmFyIGUgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3JlID0gYiwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3JlLm9wdGlvbnMgPSBhLmV4dGVuZCh7fSwgZS5EZWZhdWx0cywgdGhpcy5jb3JlLm9wdGlvbnMpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN3YXBwaW5nID0gITAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXMgPSBkLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5leHQgPSBkLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZXJzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNoYW5nZS5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5hbWVzcGFjZSAmJiAicG9zaXRpb24iID09IGEucHJvcGVydHkubmFtZSAmJiAodGhpcy5wcmV2aW91cyA9IHRoaXMuY29yZS5jdXJyZW50KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV4dCA9IGEucHJvcGVydHkudmFsdWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJkcmFnLm93bC5jYXJvdXNlbCBkcmFnZ2VkLm93bC5jYXJvdXNlbCB0cmFuc2xhdGVkLm93bC5jYXJvdXNlbCI6IGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubmFtZXNwYWNlICYmICh0aGlzLnN3YXBwaW5nID0gInRyYW5zbGF0ZWQiID09IGEudHlwZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInRyYW5zbGF0ZS5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5hbWVzcGFjZSAmJiB0aGlzLnN3YXBwaW5nICYmICh0aGlzLmNvcmUub3B0aW9ucy5hbmltYXRlT3V0IHx8IHRoaXMuY29yZS5vcHRpb25zLmFuaW1hdGVJbikgJiYgdGhpcy5zd2FwKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29yZS4kZWxlbWVudC5vbih0aGlzLmhhbmRsZXJzKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGUuRGVmYXVsdHMgPSB7CiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZU91dDogITEsCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZUluOiAhMQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5zd2FwID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgxID09PSB0aGlzLmNvcmUuc2V0dGluZ3MuaXRlbXMgJiYgYS5zdXBwb3J0LmFuaW1hdGlvbiAmJiBhLnN1cHBvcnQudHJhbnNpdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3JlLnNwZWVkKDApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIsIGMgPSBhLnByb3h5KHRoaXMuY2xlYXIsIHRoaXMpLCBkID0gdGhpcy5jb3JlLiRzdGFnZS5jaGlsZHJlbigpLmVxKHRoaXMucHJldmlvdXMpLCBlID0gdGhpcy5jb3JlLiRzdGFnZS5jaGlsZHJlbigpLmVxKHRoaXMubmV4dCksIGYgPSB0aGlzLmNvcmUuc2V0dGluZ3MuYW5pbWF0ZUluLCBnID0gdGhpcy5jb3JlLnNldHRpbmdzLmFuaW1hdGVPdXQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvcmUuY3VycmVudCgpICE9PSB0aGlzLnByZXZpb3VzICYmIChnICYmIChiID0gdGhpcy5jb3JlLmNvb3JkaW5hdGVzKHRoaXMucHJldmlvdXMpIC0gdGhpcy5jb3JlLmNvb3JkaW5hdGVzKHRoaXMubmV4dCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5vbmUoYS5zdXBwb3J0LmFuaW1hdGlvbi5lbmQsIGMpLmNzcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQ6IGIgKyAicHgiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuYWRkQ2xhc3MoImFuaW1hdGVkIG93bC1hbmltYXRlZC1vdXQiKS5hZGRDbGFzcyhnKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmICYmIGUub25lKGEuc3VwcG9ydC5hbmltYXRpb24uZW5kLCBjKS5hZGRDbGFzcygiYW5pbWF0ZWQgb3dsLWFuaW1hdGVkLWluIikuYWRkQ2xhc3MoZikpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICAgICAgICBhKGIudGFyZ2V0KS5jc3MoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogIiIKICAgICAgICAgICAgICAgICAgICAgICAgfSkucmVtb3ZlQ2xhc3MoImFuaW1hdGVkIG93bC1hbmltYXRlZC1vdXQgb3dsLWFuaW1hdGVkLWluIikucmVtb3ZlQ2xhc3ModGhpcy5jb3JlLnNldHRpbmdzLmFuaW1hdGVJbikucmVtb3ZlQ2xhc3ModGhpcy5jb3JlLnNldHRpbmdzLmFuaW1hdGVPdXQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3JlLm9uVHJhbnNpdGlvbkVuZCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5kZXN0cm95ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhLCBiOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgaW4gdGhpcy5oYW5kbGVycykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29yZS4kZWxlbWVudC5vZmYoYSwgdGhpcy5oYW5kbGVyc1thXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYiBpbiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmdW5jdGlvbiIgIT0gdHlwZW9mIHRoaXNbYl0gJiYgKHRoaXNbYl0gPSBudWxsKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgYS5mbi5vd2xDYXJvdXNlbC5Db25zdHJ1Y3Rvci5QbHVnaW5zLkFuaW1hdGUgPSBlCiAgICAgICAgICAgIH0od2luZG93LlplcHRvIHx8IHdpbmRvdy5qUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpLAogICAgICAgICAgICBmdW5jdGlvbihhLCBiLCBjLCBkKSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlID0gYiwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FsbCA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWUgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90aW1lb3V0ID0gMCwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGF1c2VkID0gITAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZXJzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNoYW5nZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5uYW1lc3BhY2UgJiYgInNldHRpbmdzIiA9PT0gYS5wcm9wZXJ0eS5uYW1lID8gdGhpcy5fY29yZS5zZXR0aW5ncy5hdXRvcGxheSA/IHRoaXMucGxheSgpIDogdGhpcy5zdG9wKCkgOiBhLm5hbWVzcGFjZSAmJiAicG9zaXRpb24iID09PSBhLnByb3BlcnR5Lm5hbWUgJiYgdGhpcy5fcGF1c2VkICYmICh0aGlzLl90aW1lID0gMCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImluaXRpYWxpemVkLm93bC5jYXJvdXNlbCI6IGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubmFtZXNwYWNlICYmIHRoaXMuX2NvcmUuc2V0dGluZ3MuYXV0b3BsYXkgJiYgdGhpcy5wbGF5KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInBsYXkub3dsLmF1dG9wbGF5IjogYS5wcm94eShmdW5jdGlvbihhLCBiLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5uYW1lc3BhY2UgJiYgdGhpcy5wbGF5KGIsIGMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzdG9wLm93bC5hdXRvcGxheSI6IGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubmFtZXNwYWNlICYmIHRoaXMuc3RvcCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJtb3VzZW92ZXIub3dsLmF1dG9wbGF5IjogYS5wcm94eShmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnNldHRpbmdzLmF1dG9wbGF5SG92ZXJQYXVzZSAmJiB0aGlzLl9jb3JlLmlzKCJyb3RhdGluZyIpICYmIHRoaXMucGF1c2UoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibW91c2VsZWF2ZS5vd2wuYXV0b3BsYXkiOiBhLnByb3h5KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuc2V0dGluZ3MuYXV0b3BsYXlIb3ZlclBhdXNlICYmIHRoaXMuX2NvcmUuaXMoInJvdGF0aW5nIikgJiYgdGhpcy5wbGF5KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInRvdWNoc3RhcnQub3dsLmNvcmUiOiBhLnByb3h5KGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuc2V0dGluZ3MuYXV0b3BsYXlIb3ZlclBhdXNlICYmIHRoaXMuX2NvcmUuaXMoInJvdGF0aW5nIikgJiYgdGhpcy5wYXVzZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0b3VjaGVuZC5vd2wuY29yZSI6IGEucHJveHkoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS5zZXR0aW5ncy5hdXRvcGxheUhvdmVyUGF1c2UgJiYgdGhpcy5wbGF5KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuJGVsZW1lbnQub24odGhpcy5faGFuZGxlcnMpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLm9wdGlvbnMgPSBhLmV4dGVuZCh7fSwgZS5EZWZhdWx0cywgdGhpcy5fY29yZS5vcHRpb25zKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGUuRGVmYXVsdHMgPSB7CiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXk6ICExLAogICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5VGltZW91dDogNWUzLAogICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5SG92ZXJQYXVzZTogITEsCiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXlTcGVlZDogITEKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuX25leHQgPSBmdW5jdGlvbihkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhbGwgPSBiLnNldFRpbWVvdXQoYS5wcm94eSh0aGlzLl9uZXh0LCB0aGlzLCBkKSwgdGhpcy5fdGltZW91dCAqIChNYXRoLnJvdW5kKHRoaXMucmVhZCgpIC8gdGhpcy5fdGltZW91dCkgKyAxKSAtIHRoaXMucmVhZCgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS5pcygiaW50ZXJhY3RpbmciKSB8fCBjLmhpZGRlbiB8fCB0aGlzLl9jb3JlLm5leHQoZCB8fCB0aGlzLl9jb3JlLnNldHRpbmdzLmF1dG9wbGF5U3BlZWQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobmV3IERhdGUpLmdldFRpbWUoKSAtIHRoaXMuX3RpbWUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnBsYXkgPSBmdW5jdGlvbihjLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLmlzKCJyb3RhdGluZyIpIHx8IHRoaXMuX2NvcmUuZW50ZXIoInJvdGF0aW5nIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gYyB8fCB0aGlzLl9jb3JlLnNldHRpbmdzLmF1dG9wbGF5VGltZW91dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBNYXRoLm1pbih0aGlzLl90aW1lICUgKHRoaXMuX3RpbWVvdXQgfHwgYyksIGMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGF1c2VkID8gKHRoaXMuX3RpbWUgPSB0aGlzLnJlYWQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXVzZWQgPSAhMSkgOiBiLmNsZWFyVGltZW91dCh0aGlzLl9jYWxsKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWUgKz0gdGhpcy5yZWFkKCkgJSBjIC0gZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVvdXQgPSBjLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FsbCA9IGIuc2V0VGltZW91dChhLnByb3h5KHRoaXMuX25leHQsIHRoaXMsIGQpLCBjIC0gZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS5pcygicm90YXRpbmciKSAmJiAodGhpcy5fdGltZSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXVzZWQgPSAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIuY2xlYXJUaW1lb3V0KHRoaXMuX2NhbGwpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS5sZWF2ZSgicm90YXRpbmciKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUuaXMoInJvdGF0aW5nIikgJiYgIXRoaXMuX3BhdXNlZCAmJiAodGhpcy5fdGltZSA9IHRoaXMucmVhZCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGF1c2VkID0gITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLmNsZWFyVGltZW91dCh0aGlzLl9jYWxsKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEsIGI7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGEgaW4gdGhpcy5faGFuZGxlcnMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLiRlbGVtZW50Lm9mZihhLCB0aGlzLl9oYW5kbGVyc1thXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYiBpbiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmdW5jdGlvbiIgIT0gdHlwZW9mIHRoaXNbYl0gJiYgKHRoaXNbYl0gPSBudWxsKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgYS5mbi5vd2xDYXJvdXNlbC5Db25zdHJ1Y3Rvci5QbHVnaW5zLmF1dG9wbGF5ID0gZQogICAgICAgICAgICB9KHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KSwKICAgICAgICAgICAgZnVuY3Rpb24oYSwgYiwgYywgZCkgewogICAgICAgICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgICAgICAgdmFyIGUgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZSA9IGIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2luaXRpYWxpemVkID0gITEsCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhZ2VzID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xzID0ge30sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RlbXBsYXRlcyA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50ID0gdGhpcy5fY29yZS4kZWxlbWVudCwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3ZlcnJpZGVzID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dDogdGhpcy5fY29yZS5uZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldjogdGhpcy5fY29yZS5wcmV2LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG86IHRoaXMuX2NvcmUudG8KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicHJlcGFyZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5uYW1lc3BhY2UgJiYgdGhpcy5fY29yZS5zZXR0aW5ncy5kb3RzRGF0YSAmJiB0aGlzLl90ZW1wbGF0ZXMucHVzaCgnPGRpdiBjbGFzcz0iJyArIHRoaXMuX2NvcmUuc2V0dGluZ3MuZG90Q2xhc3MgKyAnIj4nICsgYShiLmNvbnRlbnQpLmZpbmQoIltkYXRhLWRvdF0iKS5hZGRCYWNrKCJbZGF0YS1kb3RdIikuYXR0cigiZGF0YS1kb3QiKSArICI8L2Rpdj4iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYWRkZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5uYW1lc3BhY2UgJiYgdGhpcy5fY29yZS5zZXR0aW5ncy5kb3RzRGF0YSAmJiB0aGlzLl90ZW1wbGF0ZXMuc3BsaWNlKGEucG9zaXRpb24sIDAsIHRoaXMuX3RlbXBsYXRlcy5wb3AoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlbW92ZS5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5hbWVzcGFjZSAmJiB0aGlzLl9jb3JlLnNldHRpbmdzLmRvdHNEYXRhICYmIHRoaXMuX3RlbXBsYXRlcy5zcGxpY2UoYS5wb3NpdGlvbiwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNoYW5nZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5uYW1lc3BhY2UgJiYgInBvc2l0aW9uIiA9PSBhLnByb3BlcnR5Lm5hbWUgJiYgdGhpcy5kcmF3KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImluaXRpYWxpemVkLm93bC5jYXJvdXNlbCI6IGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubmFtZXNwYWNlICYmICF0aGlzLl9pbml0aWFsaXplZCAmJiAodGhpcy5fY29yZS50cmlnZ2VyKCJpbml0aWFsaXplIiwgbnVsbCwgIm5hdmlnYXRpb24iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsaXplKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhdygpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbml0aWFsaXplZCA9ICEwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlLnRyaWdnZXIoImluaXRpYWxpemVkIiwgbnVsbCwgIm5hdmlnYXRpb24iKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlZnJlc2hlZC5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLm5hbWVzcGFjZSAmJiB0aGlzLl9pbml0aWFsaXplZCAmJiAodGhpcy5fY29yZS50cmlnZ2VyKCJyZWZyZXNoIiwgbnVsbCwgIm5hdmlnYXRpb24iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kcmF3KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUudHJpZ2dlcigicmVmcmVzaGVkIiwgbnVsbCwgIm5hdmlnYXRpb24iKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUub3B0aW9ucyA9IGEuZXh0ZW5kKHt9LCBlLkRlZmF1bHRzLCB0aGlzLl9jb3JlLm9wdGlvbnMpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50Lm9uKHRoaXMuX2hhbmRsZXJzKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGUuRGVmYXVsdHMgPSB7CiAgICAgICAgICAgICAgICAgICAgbmF2OiAhMSwKICAgICAgICAgICAgICAgICAgICBuYXZUZXh0OiBbJzxzcGFuIGFyaWEtbGFiZWw9IlByZXZpb3VzIj4mI3gyMDM5Ozwvc3Bhbj4nLCAnPHNwYW4gYXJpYS1sYWJlbD0iTmV4dCI+JiN4MjAzYTs8L3NwYW4+J10sCiAgICAgICAgICAgICAgICAgICAgbmF2U3BlZWQ6ICExLAogICAgICAgICAgICAgICAgICAgIG5hdkVsZW1lbnQ6ICdidXR0b24gdHlwZT0iYnV0dG9uIiByb2xlPSJwcmVzZW50YXRpb24iJywKICAgICAgICAgICAgICAgICAgICBuYXZDb250YWluZXI6ICExLAogICAgICAgICAgICAgICAgICAgIG5hdkNvbnRhaW5lckNsYXNzOiAib3dsLW5hdiIsCiAgICAgICAgICAgICAgICAgICAgbmF2Q2xhc3M6IFsib3dsLXByZXYiLCAib3dsLW5leHQiXSwKICAgICAgICAgICAgICAgICAgICBzbGlkZUJ5OiAxLAogICAgICAgICAgICAgICAgICAgIGRvdENsYXNzOiAib3dsLWRvdCIsCiAgICAgICAgICAgICAgICAgICAgZG90c0NsYXNzOiAib3dsLWRvdHMiLAogICAgICAgICAgICAgICAgICAgIGRvdHM6ICEwLAogICAgICAgICAgICAgICAgICAgIGRvdHNFYWNoOiAhMSwKICAgICAgICAgICAgICAgICAgICBkb3RzRGF0YTogITEsCiAgICAgICAgICAgICAgICAgICAgZG90c1NwZWVkOiAhMSwKICAgICAgICAgICAgICAgICAgICBkb3RzQ29udGFpbmVyOiAhMQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiLCBjID0gdGhpcy5fY29yZS5zZXR0aW5nczsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbHMuJHJlbGF0aXZlID0gKGMubmF2Q29udGFpbmVyID8gYShjLm5hdkNvbnRhaW5lcikgOiBhKCI8ZGl2PiIpLmFkZENsYXNzKGMubmF2Q29udGFpbmVyQ2xhc3MpLmFwcGVuZFRvKHRoaXMuJGVsZW1lbnQpKS5hZGRDbGFzcygiZGlzYWJsZWQiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xzLiRwcmV2aW91cyA9IGEoIjwiICsgYy5uYXZFbGVtZW50ICsgIj4iKS5hZGRDbGFzcyhjLm5hdkNsYXNzWzBdKS5odG1sKGMubmF2VGV4dFswXSkucHJlcGVuZFRvKHRoaXMuX2NvbnRyb2xzLiRyZWxhdGl2ZSkub24oImNsaWNrIiwgYS5wcm94eShmdW5jdGlvbihhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2KGMubmF2U3BlZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9scy4kbmV4dCA9IGEoIjwiICsgYy5uYXZFbGVtZW50ICsgIj4iKS5hZGRDbGFzcyhjLm5hdkNsYXNzWzFdKS5odG1sKGMubmF2VGV4dFsxXSkuYXBwZW5kVG8odGhpcy5fY29udHJvbHMuJHJlbGF0aXZlKS5vbigiY2xpY2siLCBhLnByb3h5KGZ1bmN0aW9uKGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5leHQoYy5uYXZTcGVlZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKSwKICAgICAgICAgICAgICAgICAgICAgICAgYy5kb3RzRGF0YSB8fCAodGhpcy5fdGVtcGxhdGVzID0gW2EoJzxidXR0b24gcm9sZT0iYnV0dG9uIj4nKS5hZGRDbGFzcyhjLmRvdENsYXNzKS5hcHBlbmQoYSgiPHNwYW4+IikpLnByb3AoIm91dGVySFRNTCIpXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9scy4kYWJzb2x1dGUgPSAoYy5kb3RzQ29udGFpbmVyID8gYShjLmRvdHNDb250YWluZXIpIDogYSgiPGRpdj4iKS5hZGRDbGFzcyhjLmRvdHNDbGFzcykuYXBwZW5kVG8odGhpcy4kZWxlbWVudCkpLmFkZENsYXNzKCJkaXNhYmxlZCIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbHMuJGFic29sdXRlLm9uKCJjbGljayIsICJidXR0b24iLCBhLnByb3h5KGZ1bmN0aW9uKGIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZCA9IGEoYi50YXJnZXQpLnBhcmVudCgpLmlzKHRoaXMuX2NvbnRyb2xzLiRhYnNvbHV0ZSkgPyBhKGIudGFyZ2V0KS5pbmRleCgpIDogYShiLnRhcmdldCkucGFyZW50KCkuaW5kZXgoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiLnByZXZlbnREZWZhdWx0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG8oZCwgYy5kb3RzU3BlZWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYiBpbiB0aGlzLl9vdmVycmlkZXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlW2JdID0gYS5wcm94eSh0aGlzW2JdLCB0aGlzKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSwgYiwgYywgZCwgZTsKICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHRoaXMuX2NvcmUuc2V0dGluZ3M7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYSBpbiB0aGlzLl9oYW5kbGVycykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQub2ZmKGEsIHRoaXMuX2hhbmRsZXJzW2FdKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChiIGluIHRoaXMuX2NvbnRyb2xzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIiRyZWxhdGl2ZSIgPT09IGIgJiYgZS5uYXZDb250YWluZXIgPyB0aGlzLl9jb250cm9sc1tiXS5odG1sKCIiKSA6IHRoaXMuX2NvbnRyb2xzW2JdLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGQgaW4gdGhpcy5vdmVyaWRlcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmVbZF0gPSB0aGlzLl9vdmVycmlkZXNbZF07CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoYyBpbiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJmdW5jdGlvbiIgIT0gdHlwZW9mIHRoaXNbY10gJiYgKHRoaXNbY10gPSBudWxsKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhLCBiLCBjLCBkID0gdGhpcy5fY29yZS5jbG9uZXMoKS5sZW5ndGggLyAyLCBlID0gZCArIHRoaXMuX2NvcmUuaXRlbXMoKS5sZW5ndGgsIGYgPSB0aGlzLl9jb3JlLm1heGltdW0oITApLCBnID0gdGhpcy5fY29yZS5zZXR0aW5ncywgaCA9IGcuY2VudGVyIHx8IGcuYXV0b1dpZHRoIHx8IGcuZG90c0RhdGEgPyAxIDogZy5kb3RzRWFjaCB8fCBnLml0ZW1zOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoInBhZ2UiICE9PSBnLnNsaWRlQnkgJiYgKGcuc2xpZGVCeSA9IE1hdGgubWluKGcuc2xpZGVCeSwgZy5pdGVtcykpLAogICAgICAgICAgICAgICAgICAgICAgICBnLmRvdHMgfHwgInBhZ2UiID09IGcuc2xpZGVCeSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodGhpcy5fcGFnZXMgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gMDsgYSA8IGU7IGErKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiID49IGggfHwgMCA9PT0gYikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcGFnZXMucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogTWF0aC5taW4oZiwgYSAtIGQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kOiBhIC0gZCArIGggLSAxCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihmLCBhIC0gZCkgPT09IGYpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArK2MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYiArPSB0aGlzLl9jb3JlLm1lcmdlcnModGhpcy5fY29yZS5yZWxhdGl2ZShhKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGUucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIsIGMgPSB0aGlzLl9jb3JlLnNldHRpbmdzLCBkID0gdGhpcy5fY29yZS5pdGVtcygpLmxlbmd0aCA8PSBjLml0ZW1zLCBlID0gdGhpcy5fY29yZS5yZWxhdGl2ZSh0aGlzLl9jb3JlLmN1cnJlbnQoKSksIGYgPSBjLmxvb3AgfHwgYy5yZXdpbmQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xzLiRyZWxhdGl2ZS50b2dnbGVDbGFzcygiZGlzYWJsZWQiLCAhYy5uYXYgfHwgZCksCiAgICAgICAgICAgICAgICAgICAgICAgIGMubmF2ICYmICh0aGlzLl9jb250cm9scy4kcHJldmlvdXMudG9nZ2xlQ2xhc3MoImRpc2FibGVkIiwgIWYgJiYgZSA8PSB0aGlzLl9jb3JlLm1pbmltdW0oITApKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xzLiRuZXh0LnRvZ2dsZUNsYXNzKCJkaXNhYmxlZCIsICFmICYmIGUgPj0gdGhpcy5fY29yZS5tYXhpbXVtKCEwKSkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbHMuJGFic29sdXRlLnRvZ2dsZUNsYXNzKCJkaXNhYmxlZCIsICFjLmRvdHMgfHwgZCksCiAgICAgICAgICAgICAgICAgICAgICAgIGMuZG90cyAmJiAoYiA9IHRoaXMuX3BhZ2VzLmxlbmd0aCAtIHRoaXMuX2NvbnRyb2xzLiRhYnNvbHV0ZS5jaGlsZHJlbigpLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMuZG90c0RhdGEgJiYgMCAhPT0gYiA/IHRoaXMuX2NvbnRyb2xzLiRhYnNvbHV0ZS5odG1sKHRoaXMuX3RlbXBsYXRlcy5qb2luKCIiKSkgOiBiID4gMCA/IHRoaXMuX2NvbnRyb2xzLiRhYnNvbHV0ZS5hcHBlbmQobmV3IEFycmF5KGIgKyAxKS5qb2luKHRoaXMuX3RlbXBsYXRlc1swXSkpIDogYiA8IDAgJiYgdGhpcy5fY29udHJvbHMuJGFic29sdXRlLmNoaWxkcmVuKCkuc2xpY2UoYikucmVtb3ZlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9scy4kYWJzb2x1dGUuZmluZCgiLmFjdGl2ZSIpLnJlbW92ZUNsYXNzKCJhY3RpdmUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xzLiRhYnNvbHV0ZS5jaGlsZHJlbigpLmVxKGEuaW5BcnJheSh0aGlzLmN1cnJlbnQoKSwgdGhpcy5fcGFnZXMpKS5hZGRDbGFzcygiYWN0aXZlIikpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5vblRyaWdnZXIgPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gdGhpcy5fY29yZS5zZXR0aW5nczsKICAgICAgICAgICAgICAgICAgICAgICAgYi5wYWdlID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGEuaW5BcnJheSh0aGlzLmN1cnJlbnQoKSwgdGhpcy5fcGFnZXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnQ6IHRoaXMuX3BhZ2VzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IGMgJiYgKGMuY2VudGVyIHx8IGMuYXV0b1dpZHRoIHx8IGMuZG90c0RhdGEgPyAxIDogYy5kb3RzRWFjaCB8fCBjLml0ZW1zKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5jdXJyZW50ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5fY29yZS5yZWxhdGl2ZSh0aGlzLl9jb3JlLmN1cnJlbnQoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmdyZXAodGhpcy5fcGFnZXMsIGEucHJveHkoZnVuY3Rpb24oYSwgYykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEuc3RhcnQgPD0gYiAmJiBhLmVuZCA+PSBiCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpKS5wb3AoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSBmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjLCBkLCBlID0gdGhpcy5fY29yZS5zZXR0aW5nczsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJwYWdlIiA9PSBlLnNsaWRlQnkgPyAoYyA9IGEuaW5BcnJheSh0aGlzLmN1cnJlbnQoKSwgdGhpcy5fcGFnZXMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHRoaXMuX3BhZ2VzLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPyArK2MgOiAtLWMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gdGhpcy5fcGFnZXNbKGMgJSBkICsgZCkgJSBkXS5zdGFydCkgOiAoYyA9IHRoaXMuX2NvcmUucmVsYXRpdmUodGhpcy5fY29yZS5jdXJyZW50KCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IHRoaXMuX2NvcmUuaXRlbXMoKS5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID8gYyArPSBlLnNsaWRlQnkgOiBjIC09IGUuc2xpZGVCeSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5uZXh0ID0gZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICAgICAgICBhLnByb3h5KHRoaXMuX292ZXJyaWRlcy50bywgdGhpcy5fY29yZSkodGhpcy5nZXRQb3NpdGlvbighMCksIGIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS5wcmV2ID0gZnVuY3Rpb24oYikgewogICAgICAgICAgICAgICAgICAgICAgICBhLnByb3h5KHRoaXMuX292ZXJyaWRlcy50bywgdGhpcy5fY29yZSkodGhpcy5nZXRQb3NpdGlvbighMSksIGIpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICwKICAgICAgICAgICAgICAgICAgICBlLnByb3RvdHlwZS50byA9IGZ1bmN0aW9uKGIsIGMsIGQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGU7CiAgICAgICAgICAgICAgICAgICAgICAgICFkICYmIHRoaXMuX3BhZ2VzLmxlbmd0aCA/IChlID0gdGhpcy5fcGFnZXMubGVuZ3RoLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5wcm94eSh0aGlzLl9vdmVycmlkZXMudG8sIHRoaXMuX2NvcmUpKHRoaXMuX3BhZ2VzWyhiICUgZSArIGUpICUgZV0uc3RhcnQsIGMpKSA6IGEucHJveHkodGhpcy5fb3ZlcnJpZGVzLnRvLCB0aGlzLl9jb3JlKShiLCBjKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAsCiAgICAgICAgICAgICAgICAgICAgYS5mbi5vd2xDYXJvdXNlbC5Db25zdHJ1Y3Rvci5QbHVnaW5zLk5hdmlnYXRpb24gPSBlCiAgICAgICAgICAgIH0od2luZG93LlplcHRvIHx8IHdpbmRvdy5qUXVlcnksIHdpbmRvdywgZG9jdW1lbnQpLAogICAgICAgICAgICBmdW5jdGlvbihhLCBiLCBjLCBkKSB7CiAgICAgICAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGZ1bmN0aW9uKGMpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb3JlID0gYywKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFzaGVzID0ge30sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGVsZW1lbnQgPSB0aGlzLl9jb3JlLiRlbGVtZW50LAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVycyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJpbml0aWFsaXplZC5vd2wuY2Fyb3VzZWwiOiBhLnByb3h5KGZ1bmN0aW9uKGMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjLm5hbWVzcGFjZSAmJiAiVVJMSGFzaCIgPT09IHRoaXMuX2NvcmUuc2V0dGluZ3Muc3RhcnRQb3NpdGlvbiAmJiBhKGIpLnRyaWdnZXIoImhhc2hjaGFuZ2Uub3dsLm5hdmlnYXRpb24iKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicHJlcGFyZWQub3dsLmNhcm91c2VsIjogYS5wcm94eShmdW5jdGlvbihiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIubmFtZXNwYWNlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gYShiLmNvbnRlbnQpLmZpbmQoIltkYXRhLWhhc2hdIikuYWRkQmFjaygiW2RhdGEtaGFzaF0iKS5hdHRyKCJkYXRhLWhhc2giKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNoZXNbY10gPSBiLmNvbnRlbnQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjaGFuZ2VkLm93bC5jYXJvdXNlbCI6IGEucHJveHkoZnVuY3Rpb24oYykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjLm5hbWVzcGFjZSAmJiAicG9zaXRpb24iID09PSBjLnByb3BlcnR5Lm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSB0aGlzLl9jb3JlLml0ZW1zKHRoaXMuX2NvcmUucmVsYXRpdmUodGhpcy5fY29yZS5jdXJyZW50KCkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gYS5tYXAodGhpcy5faGFzaGVzLCBmdW5jdGlvbihhLCBiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSA9PT0gZCA/IGIgOiBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmpvaW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlIHx8IGIubG9jYXRpb24uaGFzaC5zbGljZSgxKSA9PT0gZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYi5sb2NhdGlvbi5oYXNoID0gZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIHRoaXMpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvcmUub3B0aW9ucyA9IGEuZXh0ZW5kKHt9LCBlLkRlZmF1bHRzLCB0aGlzLl9jb3JlLm9wdGlvbnMpLAogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbGVtZW50Lm9uKHRoaXMuX2hhbmRsZXJzKSwKICAgICAgICAgICAgICAgICAgICAgICAgYShiKS5vbigiaGFzaGNoYW5nZS5vd2wubmF2aWdhdGlvbiIsIGEucHJveHkoZnVuY3Rpb24oYSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiLmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLCBlID0gdGhpcy5fY29yZS4kc3RhZ2UuY2hpbGRyZW4oKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICwgZiA9IHRoaXMuX2hhc2hlc1tjXSAmJiBlLmluZGV4KHRoaXMuX2hhc2hlc1tjXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmICE9PSBkICYmIGYgIT09IHRoaXMuX2NvcmUuY3VycmVudCgpICYmIHRoaXMuX2NvcmUudG8odGhpcy5fY29yZS5yZWxhdGl2ZShmKSwgITEsICEwKQogICAgICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKSkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBlLkRlZmF1bHRzID0gewogICAgICAgICAgICAgICAgICAgIFVSTGhhc2hMaXN0ZW5lcjogITEKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZS5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYywgZDsKICAgICAgICAgICAgICAgICAgICAgICAgYShiKS5vZmYoImhhc2hjaGFuZ2Uub3dsLm5hdmlnYXRpb24iKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjIGluIHRoaXMuX2hhbmRsZXJzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29yZS4kZWxlbWVudC5vZmYoYywgdGhpcy5faGFuZGxlcnNbY10pOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGQgaW4gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZnVuY3Rpb24iICE9IHR5cGVvZiB0aGlzW2RdICYmICh0aGlzW2RdID0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLAogICAgICAgICAgICAgICAgICAgIGEuZm4ub3dsQ2Fyb3VzZWwuQ29uc3RydWN0b3IuUGx1Z2lucy5IYXNoID0gZQogICAgICAgICAgICB9KHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KSwKICAgICAgICAgICAgZnVuY3Rpb24oYSwgYiwgYywgZCkgewogICAgICAgICAgICAgICAgZnVuY3Rpb24gZShiLCBjKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSAhMQogICAgICAgICAgICAgICAgICAgICAgICAsIGYgPSBiLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgYi5zbGljZSgxKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5lYWNoKChiICsgIiAiICsgaC5qb2luKGYgKyAiICIpICsgZikuc3BsaXQoIiAiKSwgZnVuY3Rpb24oYSwgYikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ1tiXSAhPT0gZCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlID0gIWMgfHwgYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhMQogICAgICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgICAgICAgICBlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBmKGEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZShhLCAhMCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHZhciBnID0gYSgiPHN1cHBvcnQ+IikuZ2V0KDApLnN0eWxlCiAgICAgICAgICAgICAgICAgICAgLCBoID0gIldlYmtpdCBNb3ogTyBtcyIuc3BsaXQoIiAiKQogICAgICAgICAgICAgICAgICAgICwgaSA9IHsKICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgV2Via2l0VHJhbnNpdGlvbjogIndlYmtpdFRyYW5zaXRpb25FbmQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgTW96VHJhbnNpdGlvbjogInRyYW5zaXRpb25lbmQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgT1RyYW5zaXRpb246ICJvVHJhbnNpdGlvbkVuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiAidHJhbnNpdGlvbmVuZCIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVuZDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgV2Via2l0QW5pbWF0aW9uOiAid2Via2l0QW5pbWF0aW9uRW5kIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1vekFuaW1hdGlvbjogImFuaW1hdGlvbmVuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPQW5pbWF0aW9uOiAib0FuaW1hdGlvbkVuZCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICJhbmltYXRpb25lbmQiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLCBqID0gewogICAgICAgICAgICAgICAgICAgIGNzc3RyYW5zZm9ybXM6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gISFlKCJ0cmFuc2Zvcm0iKQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgY3NzdHJhbnNmb3JtczNkOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICEhZSgicGVyc3BlY3RpdmUiKQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgY3NzdHJhbnNpdGlvbnM6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gISFlKCJ0cmFuc2l0aW9uIikKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGNzc2FuaW1hdGlvbnM6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gISFlKCJhbmltYXRpb24iKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBqLmNzc3RyYW5zaXRpb25zKCkgJiYgKGEuc3VwcG9ydC50cmFuc2l0aW9uID0gbmV3IFN0cmluZyhmKCJ0cmFuc2l0aW9uIikpLAogICAgICAgICAgICAgICAgICAgIGEuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCA9IGkudHJhbnNpdGlvbi5lbmRbYS5zdXBwb3J0LnRyYW5zaXRpb25dKSwKICAgICAgICAgICAgICAgIGouY3NzYW5pbWF0aW9ucygpICYmIChhLnN1cHBvcnQuYW5pbWF0aW9uID0gbmV3IFN0cmluZyhmKCJhbmltYXRpb24iKSksCiAgICAgICAgICAgICAgICAgICAgYS5zdXBwb3J0LmFuaW1hdGlvbi5lbmQgPSBpLmFuaW1hdGlvbi5lbmRbYS5zdXBwb3J0LmFuaW1hdGlvbl0pLAogICAgICAgICAgICAgICAgai5jc3N0cmFuc2Zvcm1zKCkgJiYgKGEuc3VwcG9ydC50cmFuc2Zvcm0gPSBuZXcgU3RyaW5nKGYoInRyYW5zZm9ybSIpKSwKICAgICAgICAgICAgICAgICAgICBhLnN1cHBvcnQudHJhbnNmb3JtM2QgPSBqLmNzc3RyYW5zZm9ybXMzZCgpKQogICAgICAgICAgICB9KHdpbmRvdy5aZXB0byB8fCB3aW5kb3cualF1ZXJ5LCB3aW5kb3csIGRvY3VtZW50KTsKCiAgICA8L3NjcmlwdD4=</text>
      </register>
      <register name="3" type="2">
        <text encoding="base64">ICAgIGh0dHA6Ly9jZG4ucGNjb21wb25lbnRlcy5jb20vanMvb3dsMi9vd2wuY2Fyb3VzZWwubWluLmpzCg==</text>
      </register>
      <register name="4" type="2">
        <text encoding="base64">ICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9Pd2xDYXJvdXNlbDIvMi4zLjQvb3dsLmNhcm91c2VsLm1pbi5qcyI+PC9zY3JpcHQ+Cg==</text>
      </register>
      <register name="5" type="2">
        <text encoding="base64">ICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9Pd2xDYXJvdXNlbDIvMi4zLjQvb3dsLmNhcm91c2VsLm1pbi5qcyI+PC9zY3JpcHQ+Cg==</text>
      </register>
      <register name="6" type="2">
        <text encoding="base64">ICAgICwK</text>
      </register>
      <register name="7" type="2">
        <text encoding="base64">Cg==</text>
      </register>
      <register name="8" type="2">
        <text encoding="base64">ICAgIAo=</text>
      </register>
      <register name="9" type="4">
        <text encoding="base64">CiAgICA8c2NyaXB0IHNyYz0ie3sgYXNzZXQoJ3ZlbmRvci90aW1lbWFjaGluZS5qcyd8anNfcmV2KSB9fSI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0ie3sgYXNzZXQoJ3Byb21vdGlvbnMvYmxhY2stZnJpZGF5LTE4L2luZGV4LmpzJ3xqc19yZXYpIH19Ij48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9Pd2xDYXJvdXNlbDIvMi4zLjQvb3dsLmNhcm91c2VsLm1pbi5qcyIKICAgICAgICBvbmxvYWQ9IlBDQy5CRjE4LnNldHVwKCkiPjwvc2NyaXB0Pgo=</text>
      </register>
      <register name=":" type="4">
        <text>q</text>
      </register>
    </registers>
    <search>
      <last-search>lexi</last-search>
      <last-offset />
      <last-pattern>lexi</last-pattern>
      <last-dir>1</last-dir>
      <show-last>false</show-last>
    </search>
    <history>
      <history-search>
        <entry>gaine</entry>
        <entry>$user</entry>
        <entry>white</entry>
        <entry>erro</entry>
        <entry>sync</entry>
        <entry>lexi</entry>
      </history-search>
      <history-cmd>
        <entry>wq</entry>
        <entry>/erro</entry>
        <entry>!ls</entry>
        <entry>n</entry>
        <entry>w</entry>
        <entry>q</entry>
      </history-cmd>
      <history-expr />
      <history-input />
    </history>
    <shortcut-conflicts>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed R</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed N</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed P</text>
      </shortcut-conflict>
      <shortcut-conflict owner="vim">
        <text>ctrl pressed 2</text>
      </shortcut-conflict>
    </shortcut-conflicts>
  </component>
</application>